if (self.CavalryLogger) { CavalryLogger.start_js(["HDBo5"]); }

__d("Newline.react",[],(function(a,b,c,d,e,f){"use strict";e.exports="br"}),null);
__d("Text.react",[],(function(a,b,c,d,e,f){"use strict";e.exports="span"}),null);
__d("BaseTextWithEntities.react",["Newline.react","React","Text.react","UnicodeUtils"],(function(a,b,c,d,e,f){"use strict";__p&&__p();c=b("React").PropTypes;function g(a,b){return a.offset===b.offset&&(a.length===0||b.length===0)?a.length-b.length:a.offset-b.offset}function h(a){return[].concat(a.ranges,a.aggregatedRanges,a.imageRanges,a.metaRanges,a.inlineStyleRanges,a.textDelightRanges).filter(Boolean).sort(g)}function i(a,c){a=a.split(/(\r\n|[\r\n])/);var d=[];for(var e=0;e<a.length;e++){var f=a[e];f&&d.push(b("React").createElement(b("React").Fragment,{key:"text"+e},e%2===1?b("React").createElement(b("Newline.react"),null):c(f)))}return d}function a(a){__p&&__p();var c=0,d=null,e=a.text,f=h(a);for(var g=0;g<f.length;g++){var j=f[g];if(j.offset<c)continue;d=d||[];j.offset>c&&d.push(b("React").createElement(b("React").Fragment,{key:"text"+g},i(b("UnicodeUtils").substring(e,c,j.offset),a.textRenderer)));d.push(b("React").createElement(b("React").Fragment,{key:"range"+g},a.rangeRenderer(b("UnicodeUtils").substr(e,j.offset,j.length),j)));c=j.offset+j.length}return b("React").createElement(b("Text.react"),{className:a.className,style:a.style},d,e.length>c?i(b("UnicodeUtils").substr(e,c),a.textRenderer):null)}a.propTypes={aggregatedRanges:c.array,imageRanges:c.array,inlineStyleRanges:c.array,textDelightRanges:c.array,metaRanges:c.array,rangeRenderer:c.func.isRequired,ranges:c.arrayOf(c.shape({length:c.number,offset:c.number})),text:c.string.isRequired,textRenderer:c.func.isRequired};e.exports=a}),null);
__d("EmoticonEmojiList",[],(function(a,b,c,d,e,f){e.exports={names:{":)":"slightsmile",":-)":"slightsmile",":]":"slightsmile","=)":"smile","(:":"slightsmile","(=":"smile",":(":"frown",":-(":"frown",":[":"frown","=(":"frown",")=":"frown",";-P":"winktongue",";P":"winktongue",";-p":"winktongue",";p":"winktongue",":poop:":"poop",":P":"tongue",":-P":"tongue",":-p":"tongue",":p":"tongue","=P":"tongue","=p":"tongue","=D":"grin",":-D":"slightgrin",":D":"slightgrin",":o":"gasp",":-O":"gasp",":O":"gasp",":-o":"gasp",";)":"wink",";-)":"wink","8-)":"glasses","8)":"glasses","B-)":"glasses","B)":"glasses",">:(":"grumpy",">:-(":"grumpy",":/":"unsure",":-/":"unsure",":\\":"unsure",":-\\":"unsure","=/":"unsure","=\\":"unsure",":'(":"cry",":'-(":"cry",":\u2019(":"cry",":\u2019-(":"cry","3:)":"devil","3:-)":"devil","O:)":"angel","O:-)":"angel","0:)":"angel","0:-)":"angel",":*":"kiss",":-*":"kiss",";-*":"winkkiss",";*":"winkkiss","<3":"heart","&lt;3":"heart","\u2665":"heart","^_^":"kiki","^~^":"kiki","-_-":"expressionless",":-|":"squint",":|":"squint",">:o":"upset",">:O":"upset",">:-O":"upset",">:-o":"upset",">_<":"persevere",">.<":"persevere",'<(")':"penguin",O_O:"flushface",o_o:"flushface","0_0":"flushface",T_T:"crying","T-T":"crying",ToT:"crying","T.T":"crying","-3-":"flushkiss","'-_-":"sweating","\u2019-_-":"sweating","(y)":"like",":like:":"like","(Y)":"like","(n)":"dislike","(N)":"dislike"},emote2emojis:{slightsmile:"1f642",smile:"1f60a",frown:"1f61e",winktongue:"1f61c",poop:"1f4a9",tongue:"1f61b",slightgrin:"1f600",grin:"1f603",gasp:"1f62e",wink:"1f609",glasses:"1f60e",grumpy:"1f620",unsure:"1f615",cry:"1f622",devil:"1f608",angel:"1f607",kiss:"1f617",winkkiss:"1f618",heart:"2764",kiki:"1f60a",expressionless:"1f611",squint:"1f610",upset:"1f620",persevere:"1f623",penguin:"1f427",flushface:"1f633",crying:"1f62d",flushkiss:"1f61a",sweating:"1f613",like:"f0000",dislike:"1f44e"},symbols:{slightsmile:":)",smile:"=)",frown:":(",winktongue:";-P",poop:":poop:",tongue:":P",slightgrin:":D",grin:"=D",gasp:":o",wink:";)",glasses:"8-)",grumpy:">:(",unsure:":/",cry:":'(",devil:"3:)",angel:"O:)",kiss:":*",winkkiss:";*",heart:"<3",kiki:"^_^",expressionless:"-_-",squint:":-|",upset:">:o",persevere:">_<",penguin:'<(")',flushface:"O_O",crying:"T_T",flushkiss:"-3-",sweating:"'-_-",like:"(y)",dislike:"(n)"},regexp:/(^|[\s\'\".])(:\)(?!\))|:\-\)(?!\))|:\]|=\)(?!\))|\(:|\(=|:\(|:\-\(|:\[|=\(|\)=|;P|;\-P|;\-p|;p|:poop:|:P|:\-P|:\-p|:p|=P|=p|=D|:\-D|:D|:o|:\-O|:O|:\-o|;\)(?!\))|;\-\)(?!\))|8\-\)(?!\))|B\-\)(?!\))|B\)(?!\))|8\)(?!\))|>:\(|>:\-\(|:\/|:\-\/|:\\|:\-\\|=\/|=\\|:\'\(|:\'\-\(|:\u2019\(|:\u2019\-\(|3:\)(?!\))|3:\-\)(?!\))|O:\)(?!\))|O:\-\)(?!\))|0:\)(?!\))|0:\-\)(?!\))|:\*|:\-\*|;\*|;\-\*|<3|&lt;3|\u2665|\^_\^|\^~\^|\-_\-|:\-\||:\||>:o|>:O|>:\-O|>:\-o|>_<|>\.<|<\(\"\)(?!\))|O_O|o_o|0_0|T_T|T\-T|ToT|T\.T|\-3\-|\'\-_\-|\u2019\-_\-|\(y\)(?!\))|:like:|\(Y\)(?!\))|\(n\)(?!\))|\(N\)(?!\)))([\s\'\".,!?]|<br>|$)/,noncapturingRegexp:/(?:^|[\s\'\".])(:\)(?!\))|:\-\)(?!\))|:\]|=\)(?!\))|\(:|\(=|:\(|:\-\(|:\[|=\(|\)=|;P|;\-P|;\-p|;p|:poop:|:P|:\-P|:\-p|:p|=P|=p|=D|:\-D|:D|:o|:\-O|:O|:\-o|;\)(?!\))|;\-\)(?!\))|8\-\)(?!\))|B\-\)(?!\))|B\)(?!\))|8\)(?!\))|>:\(|>:\-\(|:\/|:\-\/|:\\|:\-\\|=\/|=\\|:\'\(|:\'\-\(|:\u2019\(|:\u2019\-\(|3:\)(?!\))|3:\-\)(?!\))|O:\)(?!\))|O:\-\)(?!\))|0:\)(?!\))|0:\-\)(?!\))|:\*|:\-\*|;\*|;\-\*|<3|&lt;3|\u2665|\^_\^|\^~\^|\-_\-|:\-\||:\||>:o|>:O|>:\-O|>:\-o|>_<|>\.<|<\(\"\)(?!\))|O_O|o_o|0_0|T_T|T\-T|ToT|T\.T|\-3\-|\'\-_\-|\u2019\-_\-|\(y\)(?!\))|:like:|\(Y\)(?!\))|\(n\)(?!\))|\(N\)(?!\)))(?:[\s\'\".,!?]|<br>|$)/}}),null);
__d("MessengerHotlikeEmoji.bs",[],(function(a,b,c,d,e,f){"use strict";var g="f0000";function a(a){return a===g}f.hotlike_key=g;f.isMessengerHotlike=a}),null);
__d("Utf16",[],(function(a,b,c,d,e,f){a={decode:function(a){switch(a.length){case 1:return a.charCodeAt(0);case 2:return 65536|(a.charCodeAt(0)-55296)*1024|a.charCodeAt(1)-56320;default:return null}},encode:function(a){if(a<65536)return String.fromCharCode(a);else return String.fromCharCode(55296+(a-65536>>10))+String.fromCharCode(56320+a%1024)}};e.exports=a}),null);
__d("messengerIterateEmoji",["MessengerSupportedEmoji","ifRequired"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d,e){__p&&__p();var f=String(a);while(f){a=b("ifRequired")("MessengerSupportedEmojiUtils",function(a){return a.getEmojiMatchObj(f)},function(){return b("MessengerSupportedEmoji").getEmojiMatchObj(f)});if(a){var g=a.offset+a.length,h=f.substr(0,a.is_supported?a.offset:g);d(h);a.is_supported&&c(a.emoji_str,a.emoji_key,e);h=f.substr(g);f=h}else break}d(f)}e.exports=a}),null);
__d("messengerIterateEmoticons",["EmoticonEmojiList"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d,e){var f,g,h;a=String(a);while(a){var i=b("EmoticonEmojiList").regexp.exec(a);if(i)f=i.index+i[1].length,g=a.substr(0,f),i=i[2],f=a.substr(f+i.length),h=b("EmoticonEmojiList").names[i],d(g),c(i,h,e),a=f;else break}d(a)}e.exports=a}),null);
__d("MessengerTextWithEmoticons.react",["cx","fbt","BaseTextWithDecoration.react","EmojiImageURL","EmoticonEmojiList","FBEmojiUtils","Image.react","MessengerHotlikeEmoji.bs","React","messengerIterateEmoji","messengerIterateEmoticons"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;function j(a,c,d,e){var f=e?128:16;a=!a&&!b("MessengerHotlikeEmoji.bs").isMessengerHotlike(d)?b("EmojiImageURL").getFBEmojiURL(b("FBEmojiUtils").resolveAliasFromKey(d)||d,f):b("EmojiImageURL").getMessengerURL(d,f);d=e?"_1ift _5m3a":"_1ift _2560";return b("React").createElement(b("Image.react"),{alt:c,className:d,src:a})}function k(a,c,d){var e=d?128:16,f=b("EmoticonEmojiList").emote2emojis[c],g=f?b("MessengerHotlikeEmoji.bs").isMessengerHotlike(f)?b("EmojiImageURL").getMessengerURL(f,e):b("EmojiImageURL").getFBEmojiURL(f,e):null;if(g){f=String.fromCodePoint(parseInt(f,e));e=d?"_1ift _5m3a":"_1ift _2560";return b("React").createElement(b("Image.react"),{alt:f,className:e,src:g})}d=h._("{emoticonName} emoticon",[h._param("emoticonName",c)]);return b("React").createElement("span",{"aria-label":d},a)}function l(a,b,c){return function(d,e,f){var g=function(c,d,a){e(b(c,d,a))};a(String(d),g,f,c)}}i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.shouldComponentUpdate=function(a){return a.text!==this.props.text};a.prototype.render=function(){var a=[l(b("messengerIterateEmoji"),j.bind(null,!!this.props.forceMessengerEmoji),this.props.customSize),l(b("messengerIterateEmoticons"),k,this.props.customSize)];return b("React").createElement(b("BaseTextWithDecoration.react"),babelHelpers["extends"]({},this.props,{text:this.props.text,decorators:a}))};function a(){i.apply(this,arguments)}a.propTypes={text:c.string,customSize:c.bool,forceMessengerEmoji:c.bool};e.exports=a}),null);
__d("MessengerTextWithEntities.react",["BaseTextWithEntities.react","Link.react","MessengerTextWithEmoticons.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;function h(a){return a.replace(/<3\b|&hearts;/g,"\u2665")}c=babelHelpers.inherits(a,b("React").Component);g=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$1=function(a){if(this.props.renderEmoticons||this.props.renderEmoji)return b("React").createElement(b("MessengerTextWithEmoticons.react"),{text:a,customSize:this.props.customSize,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji});else return h(a)}.bind(this),this.$2=function(a,c){if(this.props.interpolator)return this.props.interpolator(a,c);else return b("React").createElement(b("Link.react"),{href:c.entity},a)}.bind(this),c}a.prototype.render=function(){return b("React").createElement(b("BaseTextWithEntities.react"),babelHelpers["extends"]({},this.props,{aggregatedRanges:this.props.aggregatedRanges,imageRanges:this.props.imageRanges,metaRanges:this.props.metaRanges,rangeRenderer:this.$2,ranges:this.props.ranges,text:this.props.text,textRenderer:this.$1}))};e.exports=a}),null);
__d("MessengerLiveChatPluginTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:MessengerLiveChatPluginLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:MessengerLiveChatPluginLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:MessengerLiveChatPluginLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setAppID=function(a){this.$1.app_id=a;return this};a.prototype.setAttribution=function(a){this.$1.attribution=a;return this};a.prototype.setCallsite=function(a){this.$1.callsite=a;return this};a.prototype.setDebugData=function(a){this.$1.debug_data=a;return this};a.prototype.setDeltaType=function(a){this.$1.delta_type=a;return this};a.prototype.setDeviceParam=function(a){this.$1.device_param=a;return this};a.prototype.setDomainSource=function(a){this.$1.domain_source=a;return this};a.prototype.setDuration=function(a){this.$1.duration=a;return this};a.prototype.setEvent=function(a){this.$1.event=a;return this};a.prototype.setEventTimestamp=function(a){this.$1.event_timestamp=a;return this};a.prototype.setExceptionMessage=function(a){this.$1.exception_message=a;return this};a.prototype.setExceptionStacktrace=function(a){this.$1.exception_stacktrace=a;return this};a.prototype.setExceptionType=function(a){this.$1.exception_type=a;return this};a.prototype.setGateway=function(a){this.$1.gateway=a;return this};a.prototype.setLoggedInGreeting=function(a){this.$1.logged_in_greeting=a;return this};a.prototype.setLoggedOutGreeting=function(a){this.$1.logged_out_greeting=a;return this};a.prototype.setPageID=function(a){this.$1.page_id=a;return this};a.prototype.setRefererURI=function(a){this.$1.referer_uri=a;return this};a.prototype.setRequestHeaders=function(a){this.$1.request_headers=a;return this};a.prototype.setRequestID=function(a){this.$1.request_id=a;return this};a.prototype.setRequestParam=function(a){this.$1.request_param=a;return this};a.prototype.setSyncToken=function(a){this.$1.sync_token=a;return this};a.prototype.setThemeColor=function(a){this.$1.theme_color=a;return this};a.prototype.setUserFbid=function(a){this.$1.user_fbid=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};c={app_id:!0,attribution:!0,callsite:!0,debug_data:!0,delta_type:!0,device_param:!0,domain_source:!0,duration:!0,event:!0,event_timestamp:!0,exception_message:!0,exception_stacktrace:!0,exception_type:!0,gateway:!0,logged_in_greeting:!0,logged_out_greeting:!0,page_id:!0,referer_uri:!0,request_headers:!0,request_id:!0,request_param:!0,sync_token:!0,theme_color:!0,user_fbid:!0,vc:!0};e.exports=a}),null);
__d("MqttWsClientTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:MqttWsClientLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:MqttWsClientLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:MqttWsClientLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setAppID=function(a){this.$1.app_id=a;return this};a.prototype.setAttemptNumber=function(a){this.$1.attempt_number=a;return this};a.prototype.setConnectionStatus=function(a){this.$1.connection_status=a;return this};a.prototype.setCpState=function(a){this.$1.cp_state=a;return this};a.prototype.setDuration=function(a){this.$1.duration=a;return this};a.prototype.setErrorCode=function(a){this.$1.error_code=a;return this};a.prototype.setErrorMessage=function(a){this.$1.error_message=a;return this};a.prototype.setEventType=function(a){this.$1.event_type=a;return this};a.prototype.setHostname=function(a){this.$1.hostname=a;return this};a.prototype.setHref=function(a){this.$1.href=a;return this};a.prototype.setOnline=function(a){this.$1.online=a;return this};a.prototype.setPlatform=function(a){this.$1.platform=a;return this};a.prototype.setPublishStatus=function(a){this.$1.publish_status=a;return this};a.prototype.setSessionID=function(a){this.$1.session_id=a;return this};a.prototype.setSubscribedTopics=function(a){this.$1.subscribed_topics=b("GeneratedLoggerUtils").serializeVector(a);return this};a.prototype.setTopic=function(a){this.$1.topic=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};c={app_id:!0,attempt_number:!0,connection_status:!0,cp_state:!0,duration:!0,error_code:!0,error_message:!0,event_type:!0,hostname:!0,href:!0,online:!0,platform:!0,publish_status:!0,session_id:!0,subscribed_topics:!0,topic:!0,vc:!0};e.exports=a}),null);
__d("ContextualLayerAutoFlipHorizontal",["ContextualLayerAutoFlip"],(function(a,b,c,d,e,f){__p&&__p();var g;g=babelHelpers.inherits(a,b("ContextualLayerAutoFlip"));g&&g.prototype;a.prototype.getValidPositions=function(a){"use strict";return[a.getPosition()]};function a(){"use strict";g.apply(this,arguments)}e.exports=a}),null);
__d("MessengerContextualDialog.react",["cx","AccessibleLayer","ContextualLayerAutoFlipHorizontal","ContextualLayerUpdateOnScroll","LayerHideOnEscape","ReactAbstractContextualDialog","ReactLayer"],(function(a,b,c,d,e,f,g){"use strict";a=12;c=b("ReactLayer").createClass(b("ReactAbstractContextualDialog").createSpec({addedBehaviors:[b("ContextualLayerAutoFlipHorizontal"),b("ContextualLayerUpdateOnScroll"),b("LayerHideOnEscape"),b("AccessibleLayer")],displayName:"MessengerContextualDialog",shouldSetARIAProperties:!1,theme:{wrapperClassName:"_1r_9",arrowDimensions:{offset:a,length:16}}}));e.exports=c}),null);
__d("MessengerSpinnerReact.bs",["cx","ix","fbt","ImageReact.bs","ReasonReact.bs","joinClasses"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=h("86853"),k=h("86857"),l=h("86854"),m=b("ReasonReact.bs").statelessComponent("MessengerSpinnerReact");function n(a,c,d,e){__p&&__p();var f=a!==undefined?a:"",g=c!==undefined?c:"blue",h=d!==undefined?d:24,n=function(){var a=h===24;if(a){a=g==="blue";if(a)return j;else return k}else return l};return[m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],function(){return b("ReasonReact.bs").element(undefined,undefined,b("ImageReact.bs").make(b("joinClasses")(f,"_3u55 _3qh2"),undefined,i._("Loading..."),!0,n(0),h,undefined,h,undefined,[]))},m[9],m[10],m[11],m[12]]}a=b("ReasonReact.bs").wrapReasonForJs(m,function(a){var b=a.className,c=a.color;a=a.size;return n(b==null?"":b,c==null?"blue":c,a==null?24:a,[])});c=32;d=24;f.large_size=c;f.medium_size=d;f.blue_src=j;f.grey_src=k;f.large_blue_src=l;f.component=m;f.make=n;f.jsComponent=a}),null);
__d("MessengerSpinner.react",["MessengerSpinnerReact.bs"],(function(a,b,c,d,e,f){e.exports=b("MessengerSpinnerReact.bs").jsComponent,e.exports.large_size=b("MessengerSpinnerReact.bs").large_size,e.exports.medium_size=b("MessengerSpinnerReact.bs").medium_size}),null);
__d("MNPlatformAttributionTags",[],(function(a,b,c,d,e,f){e.exports={ATTRIBUTION_TAGS_PREFIX:"bnp:trigger:",CUSTOMER_CHAT_PLUGIN:"customer_chat_plugin",MESSENGERDOTCOM:"messengerdotcom",MESSENGER_WEB:"messenger_web",MESSENGER_WEB_SEARCH:"messenger_web_search",M_DOT_ME:"m_dot_me"}}),null);
__d("MessengerDiscoveryLoggingEnums",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ENTRYPOINT_PREFIX:"entrypoint:"})}),null);
__d("MessengerDiscoveryEntryPointsLoggingHelper",["MessengerDiscoveryEntryPoint","MessengerDiscoveryLoggingEnums"],(function(a,b,c,d,e,f){"use strict";a={getEntryPointsLoggingTagStr:function(a){if(a.length==0||Object.values(b("MessengerDiscoveryEntryPoint")).indexOf(a[0])==-1)throw new Error("Please use enums in MessengerDiscoveryEntryPoints class");return b("MessengerDiscoveryLoggingEnums").ENTRYPOINT_PREFIX+a.join(":")}};e.exports=a}),null);
__d("AsyncUploadBase",["ArbiterMixin","AsyncRequest","AsyncResponse","BrowserSupport","Form","forEachObject","mixin","removeFromArray"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));g=c&&c.prototype;a.parseFiles=function(a){"use strict";__p&&__p();var c={};b("forEachObject")(a,function(a,b){if(Array.isArray(a))c[b]=a;else{c[b]=[];if(a instanceof window.FileList)for(var d=0;d<a.length;d++)c[b].push(a.item(d));else(a instanceof window.File||a instanceof window.Blob)&&c[b].push(a)}});return c};function a(a){"use strict";g.constructor.call(this),this._customHeader={},this._inFlight=!1,this._limit=10,this._suspended=!1,a&&this.setURI(a),this.setNetworkErrorRetryLimit(0)}a.prototype.setAllowCrossOrigin=function(a){"use strict";this._allowCrossOrigin=!!a;return this};a.prototype.setAllowCrossPageTransition=function(a){"use strict";this._allowCrossPageTransition=!!a;return this};a.prototype.setCustomHttpHeader=function(a,b){"use strict";this._customHeader[a]=b;return this};a.prototype.setData=function(a){"use strict";this._data=a;return this};a.prototype.setLimit=function(a){"use strict";this._limit=a;return this};a.prototype.setNetworkErrorRetryLimit=function(a){"use strict";this._retryLimit=a;return this};a.prototype.setPreprocessHandler=function(a){"use strict";this._preprocessHandler=a;return this};a.prototype.setRelativeTo=function(a){"use strict";this._relativeTo=a;return this};a.prototype.setStatusElement=function(a){"use strict";this._statusElement=a;return this};a.prototype.setURI=function(a){"use strict";this._uri=a;return this};a.prototype.suspend=function(){"use strict";this._suspended=!0;return this};a.prototype.resume=function(){"use strict";this._suspended=!1;this._processQueue();return this};a.prototype.isUploading=function(){"use strict";return this._inFlight};a.prototype._createFileUpload=function(a,b,c){"use strict";return new h(a,b,c)};a.prototype._processQueue=function(){"use strict";__p&&__p();if(this._suspended)return;while(this._pending.length<this._limit){if(!this._waiting.length)break;var a=this._waiting.shift(),b=this._preprocessHandler;b?b(a,this._processUpload.bind(this)):this._processUpload(a);this._pending.push(a)}};a.prototype._processUpload=function(a){"use strict";__p&&__p();var c=b("Form").createFormData(a.getData()||this._data);if(a.getFile()){c.append(a.getName(),a.getFile());var d=a.getFile().uploadID;d&&c.append("upload_id",d);a.getAdditionalData().forEach(function(a,b){return c.append(b,a)})}d=new(b("AsyncRequest"))().setAllowCrossOrigin(this._allowCrossOrigin).setAllowCrossPageTransition(this._allowCrossPageTransition).setURI(this._uri).setRawData(c).setStatusElement(this._statusElement).setHandler(this._success.bind(this,a)).setErrorHandler(this._failure.bind(this,a)).setUploadProgressHandler(this._progress.bind(this,a)).setInitialHandler(this._initial.bind(this,a));for(var e in this._customHeader)d.setRequestHeader(e,this._customHeader[e]);this._relativeTo&&d.setRelativeTo(this._relativeTo);d.send();a.setAsyncRequest(d);this._inFlight=!0;a.getRetryCount()||this.inform("start",a)};a.prototype._abort=function(a){"use strict";this._pending.indexOf(a)!==-1&&(b("removeFromArray")(this._pending,a),this._processQueue()),b("removeFromArray")(this._waiting,a),a.abort()};a.prototype._initial=function(a){"use strict";if(a.isAborted())return;this.inform("initial",a)};a.prototype._success=function(a,b){"use strict";if(a.isAborted()){this.inform("success_after_abort",b);return}this._complete(a);this.inform("success",a.handleSuccess(b));this._processQueue()};a.prototype._retryUpload=function(a){"use strict";a.increaseRetryCount(),this._processUpload(a)};a.prototype._failure=function(a,c){"use strict";if(a.isAborted())return;if(c.error===1004&&a.getRetryCount()<(this._retryLimit||0))return this._retryUpload(a);this._complete(a);this.inform("failure",a.handleFailure(c))!==!1&&b("AsyncResponse").defaultErrorHandler(c);this._processQueue()};a.prototype._progress=function(a,event){"use strict";if(a.isAborted())return;this.inform("progress",a.handleProgress(event))};a.prototype._complete=function(a){"use strict";b("removeFromArray")(this._pending,a),this._pending.length||(this._inFlight=!1)};a.isSupported=function(){"use strict";return b("BrowserSupport").hasFileAPI()};function h(a,b,c){"use strict";this._allowCrossOrigin=!1,this._allowCrossPageTransition=!1,this._additionalData=new Map(),this._success=null,this._response=null,this._progressEvent=null,this._request=null,this._numRetries=0,this._aborted=!1,this._name=a,this._file=b,this._data=c}h.prototype.getName=function(){"use strict";return this._name};h.prototype.getFile=function(){"use strict";return this._file};h.prototype.setFile=function(a){"use strict";this._file=a};h.prototype.getData=function(){"use strict";return this._data};h.prototype.getAdditionalData=function(){"use strict";return this._additionalData};h.prototype.isComplete=function(){"use strict";return this._success!==null};h.prototype.isSuccess=function(){"use strict";return this._success===!0};h.prototype.getResponse=function(){"use strict";return this._response};h.prototype.getProgressEvent=function(){"use strict";return this._progressEvent};h.prototype.setAsyncRequest=function(a){"use strict";this._request=a;return this};h.prototype.increaseRetryCount=function(){"use strict";this._numRetries++;return this};h.prototype.getRetryCount=function(){"use strict";return this._numRetries};h.prototype.isWaiting=function(){"use strict";return!this._request};h.prototype.isAborted=function(){"use strict";return this._aborted};h.prototype.abort=function(){"use strict";this._request=null,this._aborted=!0};h.prototype.handleSuccess=function(a){"use strict";this._success=!0;this._response=a;this._progressEvent=null;return this};h.prototype.handleFailure=function(a){"use strict";this._success=!1;this._response=a;this._progressEvent=null;return this};h.prototype.handleProgress=function(event){"use strict";this._progressEvent=event;return this};e.exports=a}),null);
__d("AsyncUploadRequest",["AsyncUploadBase"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("AsyncUploadBase"));g=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this._files=null,this._uploads=[],this._fileLessUpload=null,b}a.prototype.setFiles=function(a){"use strict";this._files=b("AsyncUploadBase").parseFiles(a);return this};a.prototype.setAlwaysReturnResponse=function(a){"use strict";this._shouldAlwaysReturnResponse=a};a.prototype.abort=function(){"use strict";this._uploads.forEach(function(a){return this._abort(a)}.bind(this),this)};a.prototype.send=function(){"use strict";__p&&__p();if(this._inFlight)return;this._inFlight=!0;this._uploads=[];for(var a in this._files)this._files[a].forEach(function(b){this._uploads.push(this._createFileUpload(a,b))}.bind(this));this._waiting=this._uploads.slice(0);this._pending=[];this._uploads.length?this._processQueue():(this._fileLessUpload=this._createFileUpload(null,null),this._processUpload(this._fileLessUpload))};a.prototype._processQueue=function(){"use strict";g._processQueue.call(this);if(!this._pending.length&&!this._waiting.length){var a=this._uploads;a=this._shouldAlwaysReturnResponse?this._fileLessUpload!=null?{response:this._fileLessUpload.getResponse(),uploads:a}:{response:a[0].getResponse(),uploads:a}:a;this.inform("complete",a)}};a.isSupported=function(){"use strict";return b("AsyncUploadBase").isSupported()};e.exports=a}),null);
__d("FileForm",["ArbiterMixin","AsyncRequest","AsyncResponse","AsyncUploadRequest","BehaviorsMixin","CurrentUser","DataStore","DOMQuery","Event","Form","JSONPTransport","Parent","URI","isElementNode","mixin","shield"],(function(a,b,c,d,e,f){__p&&__p();var g;function h(a){var c={};a=b("DOMQuery").scry(a,'input[type="file"]');a.forEach(function(a){c[a.name]=a.files});return c}function i(a){a=b("DOMQuery").scry(a,'input[type="file"]');a.forEach(function(a){a.files=null})}c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin"),b("BehaviorsMixin")));g=c&&c.prototype;function a(a,c,d){"use strict";__p&&__p();g.constructor.call(this);this._handleSubmit=function(event){if(event.isDefaultPrevented()||event.getTarget()!==this._form)return;if(this.inform("submit")===!1){event.prevent();return}this.submit(event)}.bind(this);this.initial=function(a){return this.inform("initial",{upload:a})}.bind(this);if(a.getAttribute("rel")==="async")throw new Error("FileForm cannot be used with Primer forms.");if((a.getAttribute("method")||"").toUpperCase()!=="POST")throw new Error("FileForm must be used with POST forms.");this._form=a;this._previousEncoding=this._form.enctype;this._form.enctype=this._form.encoding="multipart/form-data";this._files=null;this._customHeader={};c&&this.enableBehaviors(c);this._options=d||{};this.setAllowCrossOrigin(this._options.allowCrossOrigin);this.setAllowCrossPageTransition(this._options.allowCrossPageTransition);this.setUploadInParallel(this._options.uploadInParallel);this.setConcurrentLimit(this._options.concurrentLimit);this.setPreprocessHandler(this._options.preprocessHandler);this.setNetworkErrorRetryLimit(this._options.networkErrorRetryLimit);this._listeners=[b("Event").listen(document.documentElement,"submit",this._handleSubmit),b("Event").listen(this._form,"click",this._click.bind(this))];b("DataStore").set(this._form,"FileForm",this)}a.prototype.getRoot=function(){"use strict";return this._form};a.prototype.setAllowCrossOrigin=function(a){"use strict";this._allowCrossOrigin=!!a;return this};a.prototype.setAllowCrossPageTransition=function(a){"use strict";this._allowCrossPageTransition=!!a;return this};a.prototype.setUploadInParallel=function(a){"use strict";this._uploadInParallel=!!a;return this};a.prototype.setConcurrentLimit=function(a){"use strict";this._concurrentLimit=a;return this};a.prototype.setCustomHttpHeader=function(a,b){"use strict";this._customHeader[a]=b;return this};a.prototype.setPreprocessHandler=function(a){"use strict";this._preprocessHandler=a;return this};a.prototype.setNetworkErrorRetryLimit=function(a){"use strict";this._retryLimit=a;return this};a.prototype.setFiles=function(a){"use strict";this._files=a;return this};a.prototype.canUseXHR=function(){"use strict";var a="FormData"in window;a&&(!new(b("URI"))(this._form.action).isSameOrigin()&&!this._allowCrossOrigin&&(!1,a=!1));return a};a.prototype._click=function(event){"use strict";__p&&__p();var a=event.getTarget();while(b("isElementNode")(a)){if(a.type==="submit"){this._clickTarget=a;setTimeout(this._unclick.bind(this),0);break}a=a.parentNode}};a.prototype._unclick=function(){"use strict";this._clickTarget=null};a.prototype._sendViaFrame=function(){"use strict";__p&&__p();var a=this._request=new(b("AsyncRequest"))();a.setStatusElement(this._getStatusElement());a.addStatusIndicator();a.setOption("useIframeTransport",!0);var c=a.handleResponse.bind(a);c=new(b("JSONPTransport"))("iframe",this._form.action,c);var d=c.getTransportFrame(),e=c.getRequestURI().addQueryData({__iframe:!0,__user:b("CurrentUser").getID()});this._form.setAttribute("action",e.toString());c.createContinuationForFileForm_DO_NOT_USE();this._form.setAttribute("target",d.name);a.setJSONPTransport(c);a.setURI(e);a.setHandler(this.success.bind(this,null));a.setErrorHandler(this.failure.bind(this,null));a.setInitialHandler(b("shield")(this.initial,this,null))};a.prototype._sendViaXHR=function(event){__p&&__p();var a=this,c;if(this._uploadInParallel&&b("AsyncUploadRequest").isSupported()){c=new(b("AsyncUploadRequest"))().setPreprocessHandler(this._preprocessHandler).setData(b("Form").serialize(this._form,this._clickTarget)).setNetworkErrorRetryLimit(this._retryLimit);for(var d in this._customHeader)c.setCustomHttpHeader(d,this._customHeader[d]);this._concurrentLimit&&c.setLimit(this._concurrentLimit);this._files?c.setFiles(this._files):c.setFiles(h(this._form));var e=[c.subscribe("progress",function(a,b){this.progress(b,b.getProgressEvent())}.bind(this)),c.subscribe("initial",function(a,b){this.initial(b)}.bind(this)),c.subscribe("success",function(a,b){this.success(b,b.getResponse())}.bind(this)),c.subscribe("start",function(a,b){this.inform("start",{upload:b})}.bind(this)),c.subscribe("failure",function(a,b){this.failure(b,b.getResponse());return!1}.bind(this)),c.subscribe("complete",function(){while(e.length)e.pop().unsubscribe()})]}else{var f,d,g;(function(){__p&&__p();var e,h=a._files;if(h){e=b("Form").createFormData(b("Form").serialize(a._form,a._clickTarget));f=b("AsyncUploadRequest").parseFiles(h);for(d in f)g=f[d],g.length===1?e.append(d,g[0]):(d=d+"[]",g.forEach(function(a){e.append(d,a)}))}else e=b("Form").createFormData(a._form,a._clickTarget);c=new(b("AsyncRequest"))().setRawData(e).setHandler(a.success.bind(a,null)).setErrorHandler(a.failure.bind(a,null)).setUploadProgressHandler(a.progress.bind(a,null)).setInitialHandler(b("shield")(a.initial,a,null));a.inform("start",{upload:null})})()}c.setAllowCrossOrigin(this._allowCrossOrigin).setAllowCrossPageTransition(this._allowCrossPageTransition).setRelativeTo(this._form).setStatusElement(this._getStatusElement()).setURI(this._form.action).send();this._request=c;event&&event.prevent()};a.prototype.forceSendViaXHR=function(){"use strict";return this._sendViaXHR(null)};a.prototype.success=function(a,c){"use strict";c={response:c,upload:a};this.inform("success",c)!==!1&&b("Event").fire(this._form,"success",c);this._cleanup()};a.prototype.failure=function(a,c){"use strict";a={response:c,upload:a};this.inform("failure",a)!==!1&&(b("Event").fire(this._form,"error",a)!==!1&&b("AsyncResponse").defaultErrorHandler(c));this._cleanup()};a.prototype.progress=function(a,event){"use strict";this.inform("progress",{event:event,upload:a})};a.prototype.abort=function(){"use strict";this._request&&(this._request.abort(),this._cleanup())};a.prototype.clear=function(){"use strict";i(this._form)};a.prototype.destroy=function(){"use strict";this._cleanup();while(this._listeners&&this._listeners.length)this._listeners.pop().remove();this._listeners=null;this._form.enctype=this._form.encoding=this._previousEncoding;b("DataStore").remove(this._form,"FileForm")};a.prototype.submit=function(event){"use strict";this.canUseXHR()?this._sendViaXHR(event):this._sendViaFrame()};a.prototype._cleanup=function(){"use strict";this._request=null};a.prototype._getStatusElement=function(){"use strict";return b("Parent").byClass(this._form,"stat_elem")||this._form};a.getInstance=function(a){"use strict";return b("DataStore").get(a,"FileForm")};Object.assign(a,{EVENTS:["start","submit","initial","progress","success","failure"]});e.exports=a}),null);
__d("PhotosUploadID",[],(function(a,b,c,d,e,f){var g=1024;a={getNewID:function(){return(g++).toString()}};e.exports=a}),null);
__d("LiveChatPluginConstants",[],(function(a,b,c,d,e,f){"use strict";a="LiveChatEvent/";b={MQTT:"mqtt",CONNECTED_STATE:"Connected",CONNECTING_STATE:"Connecting",DISCONNECTED_STATE:"Disconnected",CLOSE_TIMESTAMPS:a+"close_timestamps",RESET_BADGING:a+"reset_badging",STATE_UPDATE:a+"state",SWITCH_ACCOUNT:a+"switch_account",TYPING_UPDATE:a+"typing",UNREAD_COUNT_UPDATE:a+"unread_count"};e.exports=b}),null);
__d("LiveChatPluginLocalStorageUtil",["BanzaiODS","WebStorage"],(function(a,b,c,d,e,f){__p&&__p();var g="messenger_live_chat";function a(){"use strict";this.domain="",this.pageID="0",this.viewerID="0"}a.prototype.init=function(a,b,c){"use strict";this.domain=a,this.pageID=b,this.viewerID=c};a.prototype.getChatStarted=function(){"use strict";var a=this.getLocalState(this.domain,this.pageID,this.viewerID);return a&&a.chatStarted||!1};a.prototype.setChatStarted=function(a){"use strict";var b=this.getLocalState(this.domain,this.pageID,this.viewerID);this.setLocalState(this.domain,this.pageID,this.viewerID,babelHelpers["extends"]({},b,{chatStarted:a}))};a.prototype.getRefSent=function(){"use strict";var a=this.getLocalState(this.domain,this.pageID,this.viewerID);return a&&a.refSent||!1};a.prototype.setRefSent=function(a){"use strict";var b=this.getLocalState(this.domain,this.pageID,this.viewerID);this.setLocalState(this.domain,this.pageID,this.viewerID,babelHelpers["extends"]({},b,{refSent:a}))};a.prototype.getShowInterstitialOnPage=function(){"use strict";var a=this.getLocalState(this.domain,this.pageID,this.viewerID);return a&&a.showInterstitialOnPage||!1};a.prototype.setShowInterstitialOnPage=function(a){"use strict";var b=this.getLocalState(this.domain,this.pageID,this.viewerID);this.setLocalState(this.domain,this.pageID,this.viewerID,babelHelpers["extends"]({},b,{showInterstitialOnPage:a}))};a.prototype.getIsDialogHidden=function(){"use strict";var a=this.getLocalState(this.domain,this.pageID,this.viewerID);return a&&a.isDialogHidden||!1};a.prototype.setIsDialogHidden=function(a){"use strict";var b=this.getLocalState(this.domain,this.pageID,this.viewerID);this.setLocalState(this.domain,this.pageID,this.viewerID,babelHelpers["extends"]({},b,{isDialogHidden:a}))};a.prototype.getRequestID=function(){"use strict";var a=this.getLocalState(this.domain,this.pageID,this.viewerID);return a&&a.requestID||""};a.prototype.setRequestID=function(a){"use strict";var b=this.getLocalState(this.domain,this.pageID,this.viewerID);this.setLocalState(this.domain,this.pageID,this.viewerID,babelHelpers["extends"]({},b,{requestID:a}))};a.prototype.getLocalState=function(a,c,d){"use strict";__p&&__p();try{var e=b("WebStorage").getLocalStorageForRead();if(e){a=this.$1(a,c,d);c=e.getItem(a);if(c)return JSON.parse(c)}return null}catch(a){this.$2();return null}};a.prototype.setLocalState=function(a,c,d,e){"use strict";try{var f=b("WebStorage").getLocalStorage();if(f){a=this.$1(a,c,d);b("WebStorage").setItemGuarded(f,a,JSON.stringify(e))}}catch(a){this.$2()}};a.prototype.removeLocalState=function(a,c,d){"use strict";try{var e=b("WebStorage").getLocalStorage();if(e){a=this.$1(a,c,d);e.removeItem(a)}}catch(a){this.$2()}};a.prototype.$1=function(a,b,c){"use strict";return g+"_"+a+"_"+b+"_"+c};a.prototype.$2=function(){"use strict";b("BanzaiODS").bumpEntityKey("messenger_commerce","customer_chat_plugin.state_session_failed")};e.exports=new a()}),null);
__d("MessengerLiveChatPluginEvent",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({PLUGIN_REQUESTED:"plugin_requested",PLUGIN_REQUEST_BLOCKED:"plugin_request_blocked",PLUGIN_REQUEST_FAILED:"plugin_request_failed",PLUGIN_LOADED:"plugin_loaded",LOGGED_IN_CHAT_NOW_PROMPT_RENDERED:"logged_in_chat_now_prompt_rendered",ANONYMOUS_CHAT_NOW_PROMPT_RENDERED:"anonymous_chat_now_prompt_rendered",CHAT_DIALOG_RENDERED:"chat_dialog_rendered",RATE_LIMIT_REACHED:"rate_limit_reached",PLUGIN_TTI:"plugin_tti",CHAT_DISPLAY_DONE:"chat_display_done",LOG_IN_TO_MESSENGER_CLICKED:"log_in_to_messenger_clicked",CHAT_NOW_CLICKED:"chat_now_clicked",NOT_YOU_CLICKED:"not_you_clicked",M_DOT_ME_LINK_CLICKED:"m_dot_me_link_clicked",M_DOT_ME_LINK_RENDERED:"m_dot_me_link_rendered",MOBILE_LOGIN_PROMPT_REQUESTED:"mobile_login_prompt_requested",CONTINUE_AS_CLICKED:"continue_as_clicked",CONTINUE_AS_PROMPT_REQUESTED:"continue_as_prompt_requested",CONTINUE_AS_SUCCEED:"continue_as_succeed",CHAT_NOW_PROMPT_CLOSED:"chat_now_prompt_closed",CHAT_NOW_PROMPT_OPENED:"chat_now_prompt_opened",CHAT_DIALOG_CLOSED:"chat_dialog_closed",CHAT_DIALOG_OPENED:"chat_dialog_opened",BOT_MENU_OPENED:"bot_menu_opened",BOT_MENU_CLOSED:"bot_menu_closed",BOT_MENU_POSTBACK_CLICKED:"bot_menu_postback_clicked",BOT_MENU_URL_REDIRECT_CLICKED:"bot_menu_url_redirect_clicked",MUTE_CONVERSATION_CLICKED:"mute_conversation_clicked",UNMUTE_CONVERSATION_CLICKED:"unmute_conversation_clicked",INFORMATION_BUTTON_OPENED:"information_button_opened",INFORMATION_BUTTON_CLOSED:"information_button_closed",BLOCK_MESSAGE_CLICKED:"block_message_clicked",UNBLOCK_MESSAGE_CLICKED:"unblock_message_clicked",VIEW_ON_MESSENGER_CLICKED:"view_on_messenger_clicked",VISIT_FACEBOOK_CLICKED:"visit_facebook_clicked",LANDING_PAGE_LINK_CLICKED:"landing_page_link_clicked",ATTACHMENT_BUTTON_CLICKED:"attachment_button_clicked",ATTACHMENT_UPLOAD_SUBMITTED:"attachment_upload_submitted",ATTACHMENT_UPLOAD_COMPLETED:"attachment_upload_completed",ATTACHMENT_UPLOAD_REMOVED:"attachment_upload_removed",ATTACHMENT_UPLOAD_FAILED:"attachment_upload_failed",MESSAGE_BUBBLE_CLICKED:"message_bubble_clicked",MOBILE_PROMPT_CLOSE_CLICKED:"mobile_prompt_close_clicked",MOBILE_INTERSTITIAL_CLOSE_CLICKED:"mobile_interstitial_close_clicked",MESSAGE_SENT:"message_sent",LIKE_BUTTON_CLICKED:"like_button_clicked",QUICK_REPLY_CLICKED:"quick_reply_clicked",POSTBACK_CLICKED:"postback_clicked",REF_PARAM_SENT:"ref_param_sent",REF_PARAM_SEND_FAILED:"ref_param_send_failed",ADD_THREAD_ASSOC_FAILED:"add_thread_assoc_failed",REMOVE_THREAD_ASSOC_FAILED:"remove_thread_assoc_failed",MUTE_SETTTING_CHANGE_FAILED:"mute_setting_change_failed",DELTA_RECEIVED:"delta_received",DELTA_PARSING_ERROR:"delta_parsing_error",MQTT_CONNECTION_INITIATED:"mqtt_connection_initiated",MQTT_CONNECTION_STATE_CHANGED:"mqtt_connection_state_changed",ATTACHMENT_UPLOAD_SERVER_FAILED:"attachment_upload_server_failed"})}),null);
__d("LiveChatPluginLoggerUtil",["BanzaiODS","LiveChatPluginConstants","LiveChatPluginLocalStorageUtil","MessengerDiscoveryEntryPoint","MessengerDiscoveryEntryPointsLoggingHelper","MessengerLiveChatPluginEvent","MessengerLiveChatPluginTypedLogger","MNPlatformAttributionTags","emptyFunction","performanceAbsoluteNow"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={logAction:function(a,c,d,e,f,g,h){f===void 0&&(f=null);g===void 0&&(g=null);h===void 0&&(h=null);var i=b("LiveChatPluginLocalStorageUtil").getRequestID();new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(c).setPageID(d).setRequestID(i).setEvent(a).setEventTimestamp(Date.now()).setDebugData(e).setThemeColor(f).setLoggedInGreeting(g).setLoggedOutGreeting(h).logVital()},logTTI:function(a,c,d){this.logTTI=b("emptyFunction");d=b("performanceAbsoluteNow")()-d;new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(a).setPageID(c).setRequestID(b("LiveChatPluginLocalStorageUtil").getRequestID()).setDuration(d).setEvent(b("MessengerLiveChatPluginEvent").PLUGIN_TTI).setEventTimestamp(Date.now()).logVital()},logDelta:function(a,c,d,e){var f=b("LiveChatPluginConstants").MQTT;new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(a).setPageID(c).setRequestID(b("LiveChatPluginLocalStorageUtil").getRequestID()).setDebugData(JSON.stringify({seqId:e})).setEvent(b("MessengerLiveChatPluginEvent").DELTA_RECEIVED).setDeltaType(d).setGateway(f).setEventTimestamp(Date.now()).log();b("BanzaiODS").bumpEntityKey("messenger_commerce","customer_chat_plugin.client."+f+".delta_received."+d)},logChatDisplayDone:function(a,c,d){this.logChatDisplayDone=b("emptyFunction");d=b("performanceAbsoluteNow")()-d;new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(a).setPageID(c).setRequestID(b("LiveChatPluginLocalStorageUtil").getRequestID()).setDuration(d).setEvent(b("MessengerLiveChatPluginEvent").CHAT_DISPLAY_DONE).setEventTimestamp(Date.now()).logVital()},getAttributionTags:function(){return[b("MNPlatformAttributionTags").ATTRIBUTION_TAGS_PREFIX+b("MNPlatformAttributionTags").CUSTOMER_CHAT_PLUGIN,b("MessengerDiscoveryEntryPointsLoggingHelper").getEntryPointsLoggingTagStr([b("MessengerDiscoveryEntryPoint").CUSTOMER_CHAT_PLUGIN])]}};e.exports=a}),null);
__d("MqttLogger",["BanzaiODS","FantailLogger","FBLogger","Log","LogHistory","MqttWsClientTypedLogger","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="mqtt_client",h="MqttJsClient",i=null,j={CONNECT:"mqtt_client_connect",DISCONNECT:"mqtt_client_disconnect",PUBLISH:"mqtt_client_publish"};k.getInstance=function(){i||(i=new k());return i};function k(){this.$1=b("LogHistory").getInstance(g),this.$2=0}k.prototype.setAppId=function(a){this.$2===0&&(this.$2=a)};k.prototype.logConnect=function(a){var c=a.sessionID,d=a.connectionStatus,e=a.duration,f=a.hostname,g=a.attemptNumber,h=a.subscribedTopics,i=a.errorCode;a=a.errorMessage;var k=d?"success":"failed";this.bumpCounter(j.CONNECT+"."+k);k=new(b("MqttWsClientTypedLogger"))().setSessionID(c).setConnectionStatus(d).setDuration(e).setHostname(f).setAttemptNumber(g).setSubscribedTopics(h).setErrorCode(i).setErrorMessage(a);this.$3(j.CONNECT,k)};k.prototype.logDisconnect=function(a){var c=a.sessionID,d=a.errorCode,e=a.errorMessage;a=a.duration;this.bumpCounter(j.DISCONNECT);c=new(b("MqttWsClientTypedLogger"))().setSessionID(c).setDuration(a).setErrorCode(d).setErrorMessage(e);this.$3(j.DISCONNECT,c)};k.prototype.logPublish=function(a){var c=a.sessionID,d=a.topic,e=a.connectionStatus;a=a.publishStatus;this.bumpCounter(j.PUBLISH+"."+d);c=new(b("MqttWsClientTypedLogger"))().setSessionID(c).setTopic(d).setConnectionStatus(e).setPublishStatus(a);this.$3(j.PUBLISH,c)};k.prototype.logError=function(a,c){b("FBLogger")(g).catching(a).mustfix(c),this.$4(b("FantailLogger").error,c)};k.prototype.logErrorWarn=function(a,c){b("FBLogger")(g).catching(a).warn(c),this.$4(b("FantailLogger").warn,c)};k.prototype.logWarn=function(event,a){this.$1.warn(event,a),this.$4(b("FantailLogger").warn,a)};k.prototype.debugTrace=function(event,a){this.$1.debug(event,a),this.$4(b("FantailLogger").debug,a)};k.prototype.bumpCounter=function(a){this.$2!==0&&b("BanzaiODS").bumpEntityKey("mqtt_ws_client",this.$2+"."+a),b("BanzaiODS").bumpEntityKey("mqtt_ws_client",a)};k.prototype.$3=function(event,a){a.setEventType(event);a.setAppID(this.$2);a.setOnline(this.$5());var c=JSON.stringify(a.getData());this.$1.log(event,c);event!==j.PUBLISH&&a.log();this.$4(b("FantailLogger").info,c)};k.prototype.$4=function(a,c){b("gkx")("676936")&&a(h,c)};k.prototype.$5=function(){return window.navigator&&window.navigator.onLine!==undefined?window.navigator.onLine:!1};e.exports=k}),null);
__d("MessageEventStream",["Int64","MercurySingletonProvider","MqttLogger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a.getForFBID=function(a){return g.getForFBID(a)};function a(a){this.$2="Disconnected",this.$1=a,this.$3=[],this.$6=b("MqttLogger").getInstance()}a.prototype.init=function(a,c,d,e){__p&&__p();if(!c&&!e)return this;this.$10=a;this.$9=!0;this.$4=c?b("Int64").fromString(c):null;this.$7=d;this.$8=e;this.$5=null;this.$10.subscribe("/t_ms",function(a){return this.$11(a)}.bind(this));this.$10.subscribe("/thread_typing",function(a){this.$12(a)}.bind(this));this.$10.subscribe("/orca_typing_notifications",function(a){this.$12(a)}.bind(this));this.$10.subscribe("/notify_disconnect",function(a){return this.$13(a)}.bind(this));this.connectToIris();return this};a.prototype.connectToIris=function(a){a===void 0&&(a=null),a!==null&&(this.$4=b("Int64").fromString(a)),this.$9=!0,this.$5?this.$14():this.$15()};a.prototype.$16=function(a){var b=null;try{b=JSON.parse(a)}catch(a){this.$6.logError(a,"Unable to process data")}return b};a.prototype.$12=function(a){var b=this.$16(a);if(b==null){this.$6.logWarn("_processTypingData","Unable to process typing data");return}this.$3.forEach(function(a){typeof a.onTypingReceived==="function"&&a.onTypingReceived(b)})};a.prototype.addDeltaStreamListener=function(a){this.$3.push(a)};a.prototype.$13=function(a){this.$6.logWarn("_handleNotifyDisconnect","Disconnecting reason: "+a),a==="IRIS_CURSOR_LIMIT"&&(this.$5=null,this.$9=!1),this.$17(a)};a.prototype.$17=function(a){this.$6.bumpCounter(a+"_request"),this.$3.forEach(function(b){return b.onStreamDisconnect(a)})};a.prototype.$11=function(a){__p&&__p();a=this.$16(a);if(a==null){this.$6.logWarn("_processDeltas","Unable to process delta");return}var b=this.$1;if(a.syncToken){this.$18(a);return}else if(a.queueEntityId!=b){this.$6.bumpCounter("delta_for_other_fbid");return}else a.errorCode?this.$19(a.errorCode):this.$20(a)};a.prototype.$19=function(a){this.$6.bumpCounter("iris_queue_error."+a),this.$6.logWarn("_handleIrisError","Recevied an error code from sync protocol "+a),this.$5=null,this.$9=!1,this.$17(a)};a.prototype.$18=function(a){this.$5=a.syncToken,this.$4=b("Int64").fromString(a.firstDeltaSeqId.toString()),this.$10.subscribeChannelEvents({onMQTTStateChanged:function(a){this.$9&&this.$2!=="Connected"&&a==="Connected"&&this.connectToIris(),this.$2=a}.bind(this)}),this.$2="Connected"};a.prototype.$20=function(a){var c=a.deltas,d=this.$4;if(c&&d){var e=b("Int64").fromString(a.firstDeltaSeqId.toString());a=b("Int64").fromString(a.lastIssuedSeqId.toString());e.equals(d.add(b("Int64").ONE))?this.$21(e,a,c):e.compare(d)<0?(this.$6.bumpCounter("delta_batch_in_middle"),a.compare(d)>0&&this.$21(d.add(b("Int64").ONE),a,c)):(this.$6.bumpCounter("missing_deltas_get_diffs"),this.$14())}else this.$6.bumpCounter("process_deltas_invalid_state")};a.prototype.$21=function(a,c,d){__p&&__p();a=a;for(var e=0;e<d.length;e++){var f=d[e],g=f["class"]||"Missing",h={seqId:a.toString(),type:g,status:""},i=1;if(g!="Missing")try{i=this.$22(f,g,a,h)}catch(a){h.status="err:"+a.message}else h.status="no type",this.$6.bumpCounter("missing_delta_type");a=a.add(b("Int64").fromInt(i))}this.$4=c};a.prototype.$22=function(a,c,d,e){__p&&__p();var f=1,g="";c==="NoOp"&&(f=a.numNoOps||f,g+="n:"+f);a.irisSeqId||(a.irisSeqId=d.toString(),g+="missing seq id");var h=b("Int64").fromString(a.irisSeqId.toString())||d;h.equals(d)?g+=" seqId match":(g+=" seqId mismatch",this.$6.bumpCounter("seq_id_running_id_mismatch"));var i={type:c,payload:a};this.$3.forEach(function(a){return a.onDeltaReceived(i)});e.status=g;return f};a.prototype.$15=function(){var a={sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$1,initial_titan_sequence_id:this.$4&&this.$4.toString(),device_params:this.$7,queue_position:this.$8};this.$10.publish("/messenger_sync_create_queue",JSON.stringify(a))};a.prototype.$14=function(){__p&&__p();if(!this.$4){this.$6.bumpCounter("get_diffs_no_seq_id");return}if(!this.$5){this.$6.bumpCounter("get_diffs_no_sync_token");return}var a={sync_token:this.$5,sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$1,last_seq_id:this.$4.toString()};this.$10.publish("/messenger_sync_get_diffs",JSON.stringify(a))};var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/Irg6QaR_7LF/
 */
__d("paho-mqtt",[],(function(a,b,c,d,e,f){__p&&__p();(function(a,b){typeof f==="object"&&typeof e==="object"?e.exports=b():typeof define==="function"&&define.amd?define(b):typeof f==="object"?f=b():(typeof a.Paho==="undefined"&&(a.Paho={}),a.Paho.MQTT=b())})(this,function(){__p&&__p();var b=function(b){__p&&__p();var c="@VERSION@",d={CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,PUBREC:5,PUBREL:6,PUBCOMP:7,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14},e=function(a,b){__p&&__p();for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c))if(Object.prototype.hasOwnProperty.call(b,c)){if(typeof a[c]!==b[c])throw new Error(i(g.INVALID_TYPE,[typeof a[c],c]))}else{var d="Unknown property, "+c+". Valid properties are:";for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(d=d+" "+e);throw new Error(d)}},f=function(a,b){return function(){return a.apply(b,arguments)}},g={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed: code {0} reason {1} wasClean {2}."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."},BUFFER_FULL:{code:18,text:"AMQJS0018E Message buffer is full, maximum buffer size: {0}."}},h={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},i=function(a,b){__p&&__p();a=a.text;if(b){var c,d;for(var e=0;e<b.length;e++){c="{"+e+"}";d=a.indexOf(c);if(d>0){var f=a.substring(0,d);d=a.substring(d+c.length);a=f+b[e]+d}}}return a},j=[0,6,77,81,73,115,100,112,3],k=[0,4,77,81,84,84,4],l=function(a,b){this.type=a;for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(this[c]=b[c])};l.prototype.encode=function(){__p&&__p();var a=(this.type&15)<<4,b=0,c=[],e=0,f;this.messageIdentifier!==undefined&&(b+=2);switch(this.type){case d.CONNECT:switch(this.mqttVersion){case 3:b+=j.length+3;break;case 4:b+=k.length+3;break}b+=r(this.clientId)+2;this.willMessage!==undefined&&(b+=r(this.willMessage.destinationName)+2,f=this.willMessage.payloadBytes,f instanceof Uint8Array||(f=new Uint8Array(h)),b+=f.byteLength+2);this.userName!==undefined&&(b+=r(this.userName)+2);this.password!==undefined&&(b+=r(this.password)+2);break;case d.SUBSCRIBE:a|=2;for(var g=0;g<this.topics.length;g++)c[g]=r(this.topics[g]),b+=c[g]+2;b+=this.requestedQos.length;break;case d.UNSUBSCRIBE:a|=2;for(var g=0;g<this.topics.length;g++)c[g]=r(this.topics[g]),b+=c[g]+2;break;case d.PUBREL:a|=2;break;case d.PUBLISH:this.payloadMessage.duplicate&&(a|=8);a=a|=this.payloadMessage.qos<<1;this.payloadMessage.retained&&(a|=1);e=r(this.payloadMessage.destinationName);b+=e+2;var h=this.payloadMessage.payloadBytes;b+=h.byteLength;h instanceof ArrayBuffer?h=new Uint8Array(h):h instanceof Uint8Array||(h=new Uint8Array(h.buffer));break;case d.DISCONNECT:break;default:break}var i=q(b),l=i.length+1;b=new ArrayBuffer(b+l);var m=new Uint8Array(b);m[0]=a;m.set(i,1);if(this.type==d.PUBLISH)l=o(this.payloadMessage.destinationName,e,m,l);else if(this.type==d.CONNECT){switch(this.mqttVersion){case 3:m.set(j,l);l+=j.length;break;case 4:m.set(k,l);l+=k.length;break}a=0;this.cleanSession&&(a=2);this.willMessage!==undefined&&(a|=4,a|=this.willMessage.qos<<3,this.willMessage.retained&&(a|=32));this.userName!==undefined&&(a|=128);this.password!==undefined&&(a|=64);m[l++]=a;l=n(this.keepAliveInterval,m,l)}this.messageIdentifier!==undefined&&(l=n(this.messageIdentifier,m,l));switch(this.type){case d.CONNECT:l=o(this.clientId,r(this.clientId),m,l);this.willMessage!==undefined&&(l=o(this.willMessage.destinationName,r(this.willMessage.destinationName),m,l),l=n(f.byteLength,m,l),m.set(f,l),l+=f.byteLength);this.userName!==undefined&&(l=o(this.userName,r(this.userName),m,l));this.password!==undefined&&(l=o(this.password,r(this.password),m,l));break;case d.PUBLISH:m.set(h,l);break;case d.SUBSCRIBE:for(var g=0;g<this.topics.length;g++)l=o(this.topics[g],c[g],m,l),m[l++]=this.requestedQos[g];break;case d.UNSUBSCRIBE:for(var g=0;g<this.topics.length;g++)l=o(this.topics[g],c[g],m,l);break;default:}return b};function m(a,b){__p&&__p();var c=b,e=a[b],f=e>>4;e=e&=15;b+=1;var g,h=0,i=1;do{if(b==a.length)return[null,c];g=a[b++];h+=(g&127)*i;i*=128}while((g&128)!==0);g=b+h;if(g>a.length)return[null,c];i=new l(f);switch(f){case d.CONNACK:h=a[b++];h&1&&(i.sessionPresent=!0);i.returnCode=a[b++];break;case d.PUBLISH:c=e>>1&3;f=p(a,b);b+=2;h=t(a,b,f);b+=f;c>0&&(i.messageIdentifier=p(a,b),b+=2);f=new y(a.subarray(b,g));(e&1)==1&&(f.retained=!0);(e&8)==8&&(f.duplicate=!0);f.qos=c;f.destinationName=h;i.payloadMessage=f;break;case d.PUBACK:case d.PUBREC:case d.PUBREL:case d.PUBCOMP:case d.UNSUBACK:i.messageIdentifier=p(a,b);break;case d.SUBACK:i.messageIdentifier=p(a,b);b+=2;i.returnCode=a.subarray(b,g);break;default:break}return[i,g]}function n(a,b,c){b[c++]=a>>8;b[c++]=a%256;return c}function o(a,b,c,d){d=n(b,c,d);s(a,c,d);return d+b}function p(a,b){return 256*a[b]+a[b+1]}function q(a){var b=new Array(1),c=0;do{var d=a%128;a=a>>7;a>0&&(d|=128);b[c++]=d}while(a>0&&c<4);return b}function r(a){var b=0;for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);d>2047?(55296<=d&&d<=56319&&(c++,b++),b+=3):d>127?b+=2:b++}return b}function s(a,b,c){__p&&__p();c=c;for(var d=0;d<a.length;d++){var e=a.charCodeAt(d);if(55296<=e&&e<=56319){var f=a.charCodeAt(++d);if(isNaN(f))throw new Error(i(g.MALFORMED_UNICODE,[e,f]));e=(e-55296<<10)+(f-56320)+65536}e<=127?b[c++]=e:e<=2047?(b[c++]=e>>6&31|192,b[c++]=e&63|128):e<=65535?(b[c++]=e>>12&15|224,b[c++]=e>>6&63|128,b[c++]=e&63|128):(b[c++]=e>>18&7|240,b[c++]=e>>12&63|128,b[c++]=e>>6&63|128,b[c++]=e&63|128)}return b}function t(a,b,c){__p&&__p();var d="",e,f=b;while(f<b+c){var h=a[f++];if(h<128)e=h;else{var j=a[f++]-128;if(j<0)throw new Error(i(g.MALFORMED_UTF,[h.toString(16),j.toString(16),""]));if(h<224)e=64*(h-192)+j;else{var k=a[f++]-128;if(k<0)throw new Error(i(g.MALFORMED_UTF,[h.toString(16),j.toString(16),k.toString(16)]));if(h<240)e=4096*(h-224)+64*j+k;else{var l=a[f++]-128;if(l<0)throw new Error(i(g.MALFORMED_UTF,[h.toString(16),j.toString(16),k.toString(16),l.toString(16)]));if(h<248)e=262144*(h-240)+4096*j+64*k+l;else throw new Error(i(g.MALFORMED_UTF,[h.toString(16),j.toString(16),k.toString(16),l.toString(16)]))}}}e>65535&&(e-=65536,d+=String.fromCharCode(55296+(e>>10)),e=56320+(e&1023));d+=String.fromCharCode(e)}return d}var u=function(a,b,c){__p&&__p();this._client=a;this._window=b;this._keepAliveInterval=c*1e3;this.isReset=!1;var e=new l(d.PINGREQ).encode(),f=function(a){return function(){return h.apply(a)}},h=function(){!this.isReset?(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(g.PING_TIMEOUT.code,i(g.PING_TIMEOUT))):(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(e),this.timeout=this._window.setTimeout(f(this),this._keepAliveInterval))};this.reset=function(){this.isReset=!0,this._window.clearTimeout(this.timeout),this._keepAliveInterval>0&&(this.timeout=setTimeout(f(this),this._keepAliveInterval))};this.cancel=function(){this._window.clearTimeout(this.timeout)}},v=function(a,b,c,d,e){this._window=b;c||(c=30);b=function(b,a,c){return function(){return b.apply(a,c)}};this.timeout=setTimeout(b(d,a,e),c*1e3);this.cancel=function(){this._window.clearTimeout(this.timeout)}},w=function(a,c,d,e,f){__p&&__p();if(!("WebSocket"in b&&b.WebSocket!==null))throw new Error(i(g.UNSUPPORTED,["WebSocket"]));if(!("ArrayBuffer"in b&&b.ArrayBuffer!==null))throw new Error(i(g.UNSUPPORTED,["ArrayBuffer"]));this._trace("Paho.MQTT.Client",a,c,d,e,f);this.host=c;this.port=d;this.path=e;this.uri=a;this.clientId=f;this._wsuri=null;this._localKey=c+":"+d+(e!="/mqtt"?":"+e:"")+":"+f+":";this._msg_queue=[];this._buffered_msg_queue=[];this._sentMessages={};this._receivedMessages={};this._notify_msg_sent={};this._message_identifier=1;this._sequence=0};w.prototype.host=null;w.prototype.port=null;w.prototype.path=null;w.prototype.uri=null;w.prototype.clientId=null;w.prototype.socket=null;w.prototype.connected=!1;w.prototype.maxMessageIdentifier=65536;w.prototype.connectOptions=null;w.prototype.hostIndex=null;w.prototype.onConnected=null;w.prototype.onConnectionLost=null;w.prototype.onMessageDelivered=null;w.prototype.onMessageArrived=null;w.prototype.traceFunction=null;w.prototype._msg_queue=null;w.prototype._buffered_msg_queue=null;w.prototype._connectTimeout=null;w.prototype.sendPinger=null;w.prototype.receivePinger=null;w.prototype._reconnectInterval=1;w.prototype._reconnecting=!1;w.prototype._reconnectTimeout=null;w.prototype.disconnectedPublishing=!1;w.prototype.disconnectedBufferSize=5e3;w.prototype.receiveBuffer=null;w.prototype._traceBuffer=null;w.prototype._MAX_TRACE_ENTRIES=100;w.prototype.connect=function(a){__p&&__p();var b=this._traceMask(a,"password");this._trace("Client.connect",b,this.socket,this.connected);if(this.connected)throw new Error(i(g.INVALID_STATE,["already connected"]));if(this.socket)throw new Error(i(g.INVALID_STATE,["already connected"]));this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1);this.connectOptions=a;this._reconnectInterval=1;this._reconnecting=!1;a.uris?(this.hostIndex=0,this._doConnect(a.uris[0])):this._doConnect(this.uri)};w.prototype.subscribe=function(a,b){__p&&__p();this._trace("Client.subscribe",a,b);if(!this.connected)throw new Error(i(g.INVALID_STATE,["not connected"]));var c=new l(d.SUBSCRIBE);c.topics=[a];b.qos!==undefined?c.requestedQos=[b.qos]:c.requestedQos=[0];b.onSuccess&&(c.onSuccess=function(a){b.onSuccess({invocationContext:b.invocationContext,grantedQos:a})});b.onFailure&&(c.onFailure=function(a){b.onFailure({invocationContext:b.invocationContext,errorCode:a,errorMessage:i(a)})});b.timeout&&(c.timeOut=new v(this,window,b.timeout,b.onFailure,[{invocationContext:b.invocationContext,errorCode:g.SUBSCRIBE_TIMEOUT.code,errorMessage:i(g.SUBSCRIBE_TIMEOUT)}]));this._requires_ack(c);this._schedule_message(c)};w.prototype.unsubscribe=function(a,b){__p&&__p();this._trace("Client.unsubscribe",a,b);if(!this.connected)throw new Error(i(g.INVALID_STATE,["not connected"]));var c=new l(d.UNSUBSCRIBE);c.topics=[a];b.onSuccess&&(c.callback=function(){b.onSuccess({invocationContext:b.invocationContext})});b.timeout&&(c.timeOut=new v(this,window,b.timeout,b.onFailure,[{invocationContext:b.invocationContext,errorCode:g.UNSUBSCRIBE_TIMEOUT.code,errorMessage:i(g.UNSUBSCRIBE_TIMEOUT)}]));this._requires_ack(c);this._schedule_message(c)};w.prototype.send=function(a){this._trace("Client.send",a);wireMessage=new l(d.PUBLISH);wireMessage.payloadMessage=a;a.qos>0?this._requires_ack(wireMessage):this.onMessageDelivered&&(this._notify_msg_sent[wireMessage]=this.onMessageDelivered(wireMessage.payloadMessage,null));this._schedule_message(wireMessage);return wireMessage.messageIdentifier};w.prototype.disconnect=function(){this._trace("Client.disconnect");this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1);if(!this.socket)throw new Error(i(g.INVALID_STATE,["not connecting or connected"]));wireMessage=new l(d.DISCONNECT);this._notify_msg_sent[wireMessage]=f(this._disconnected,this);this._schedule_message(wireMessage)};w.prototype.getTraceLog=function(){if(this._traceBuffer!==null){this._trace("Client.getTraceLog",new Date());this._trace("Client.getTraceLog in flight messages",this._sentMessages.length);for(var a in this._sentMessages)this._trace("_sentMessages ",a,this._sentMessages[a]);for(var a in this._receivedMessages)this._trace("_receivedMessages ",a,this._receivedMessages[a]);return this._traceBuffer}};w.prototype.startTrace=function(){this._traceBuffer===null&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date(),c)};w.prototype.stopTrace=function(){delete this._traceBuffer};w.prototype._doConnect=function(a){__p&&__p();if(this.connectOptions.useSSL){var b=a.split(":");b[0]="wss";a=b.join(":")}this._wsuri=a;this.connected=!1;this.connectOptions.ignoreSubProtocol?this.socket=new WebSocket(a):this.connectOptions.mqttVersion<4?this.socket=new WebSocket(a,["mqttv3.1"]):this.socket=new WebSocket(a,["mqtt"]);this.socket.binaryType="arraybuffer";this.socket.onopen=f(this._on_socket_open,this);this.socket.onmessage=f(this._on_socket_message,this);this.socket.onerror=f(this._on_socket_error,this);this.socket.onclose=f(this._on_socket_close,this);this.sendPinger=new u(this,window,this.connectOptions.keepAliveInterval);this.receivePinger=new u(this,window,this.connectOptions.keepAliveInterval);this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null);this._connectTimeout=new v(this,window,this.connectOptions.timeout,this._disconnected,[g.CONNECT_TIMEOUT.code,i(g.CONNECT_TIMEOUT)])};w.prototype._schedule_message=function(a){this._msg_queue.push(a),this.connected&&this._process_queue()};w.prototype.store=function(a,b){};w.prototype.restore=function(a){};w.prototype._process_queue=function(){var a=null,b=this._msg_queue.reverse();while(a=b.pop())this._socket_send(a),this._notify_msg_sent[a]&&(this._notify_msg_sent[a](),delete this._notify_msg_sent[a])};w.prototype._requires_ack=function(a){var b=Object.keys(this._sentMessages).length;if(b>this.maxMessageIdentifier)throw Error("Too many messages:"+b);while(this._sentMessages[this._message_identifier]!==undefined)this._message_identifier++;a.messageIdentifier=this._message_identifier;this._sentMessages[a.messageIdentifier]=a;a.type===d.PUBLISH&&this.store("Sent:",a);this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)};w.prototype._on_socket_open=function(){var a=new l(d.CONNECT,this.connectOptions);a.clientId=this.clientId;this._socket_send(a);this.connected=!0;this.connectOptions.onSocketOpen&&this.connectOptions.onSocketOpen()};w.prototype._on_socket_message=function(event){this._trace("Client._on_socket_message",event.data);var a=this._deframeMessages(event.data);for(var b=0;b<a.length;b+=1)this._handleMessage(a[b])};w.prototype._deframeMessages=function(a){__p&&__p();a=new Uint8Array(a);var b=[];if(this.receiveBuffer){var c=new Uint8Array(this.receiveBuffer.length+a.length);c.set(this.receiveBuffer);c.set(a,this.receiveBuffer.length);a=c;delete this.receiveBuffer}try{c=0;while(c<a.length){var d=m(a,c),e=d[0];c=d[1];if(e!==null)b.push(e);else break}c<a.length&&(this.receiveBuffer=a.subarray(c))}catch(a){d=Object.prototype.hasOwnProperty.call(a,"stack")=="undefined"?a.stack.toString():"No Error Stack Available";this._disconnected(g.INTERNAL_ERROR.code,i(g.INTERNAL_ERROR,[a.message,d]));return}return b};w.prototype._handleMessage=function(a){__p&&__p();this._trace("Client._handleMessage",a);try{switch(a.type){case d.CONNACK:this._connectTimeout.cancel();this._reconnectTimeout&&this._reconnectTimeout.cancel();this.connectOptions.cleanSession&&(this._sentMessages={},this._receivedMessages={});if(a.returnCode===0)this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length);else{this.connected=!1;this._disconnected(g.CONNACK_RETURNCODE.code,i(g.CONNACK_RETURNCODE,[a.returnCode,h[a.returnCode]]),a.returnCode);break}var b=[];for(var c in this._sentMessages)Object.prototype.hasOwnProperty.call(this._sentMessages,c)&&b.push(this._sentMessages[c]);if(this._buffered_msg_queue.length>0){var e=null,f=this._buffered_msg_queue.reverse();while(e=f.pop())b.push(e),this.onMessageDelivered&&(this._notify_msg_sent[e]=this.onMessageDelivered(e.payloadMessage,null))}var b=b.sort(function(a,b){return a.sequence-b.sequence});for(var f=0,e=b.length;f<e;f++){var j=b[f];if(j.type==d.PUBLISH&&j.pubRecReceived){var k=new l(d.PUBREL,{messageIdentifier:j.messageIdentifier});this._schedule_message(k)}else this._schedule_message(j)}this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});f=!1;this._reconnecting&&(f=!0,this._reconnectInterval=1,this._reconnecting=!1);this._connected(f,this._wsuri);this._process_queue();break;case d.PUBLISH:this._receivePublish(a);break;case d.PUBACK:e=a.messageIdentifier;var j=this._sentMessages[e];j&&(delete this._sentMessages[e],this.onMessageDelivered&&this.onMessageDelivered(j.payloadMessage,e));break;case d.PUBREC:var j=this._sentMessages[a.messageIdentifier];if(j){j.pubRecReceived=!0;var k=new l(d.PUBREL,{messageIdentifier:a.messageIdentifier});this.store("Sent:",j);this._schedule_message(k)}break;case d.PUBREL:b=this._receivedMessages[a.messageIdentifier];b&&(this._receiveMessage(b),delete this._receivedMessages[a.messageIdentifier]);f=new l(d.PUBCOMP,{messageIdentifier:a.messageIdentifier});this._schedule_message(f);break;case d.PUBCOMP:e=a.messageIdentifier;var j=this._sentMessages[e];delete this._sentMessages[e];this.onMessageDelivered&&this.onMessageDelivered(j.payloadMessage,e);break;case d.SUBACK:var j=this._sentMessages[a.messageIdentifier];j&&(j.timeOut&&j.timeOut.cancel(),a.returnCode[0]===128?j.onFailure&&j.onFailure(a.returnCode):j.onSuccess&&j.onSuccess(a.returnCode),delete this._sentMessages[a.messageIdentifier]);break;case d.UNSUBACK:var j=this._sentMessages[a.messageIdentifier];j&&(j.timeOut&&j.timeOut.cancel(),j.callback&&j.callback(),delete this._sentMessages[a.messageIdentifier]);break;case d.PINGRESP:this.sendPinger.reset();break;case d.DISCONNECT:this._disconnected(g.INVALID_MQTT_MESSAGE_TYPE.code,i(g.INVALID_MQTT_MESSAGE_TYPE,[a.type]));break;default:this._disconnected(g.INVALID_MQTT_MESSAGE_TYPE.code,i(g.INVALID_MQTT_MESSAGE_TYPE,[a.type]))}}catch(a){k=Object.prototype.hasOwnProperty.call(a,"stack")=="undefined"?a.stack.toString():"No Error Stack Available";this._disconnected(g.INTERNAL_ERROR.code,i(g.INTERNAL_ERROR,[a.message,k]));return}};w.prototype._on_socket_error=function(a){this._reconnecting||this._disconnected(g.SOCKET_ERROR.code,i(g.SOCKET_ERROR,[a.data])),this.connectOptions.onSocketError&&this.connectOptions.onSocketError(a)};w.prototype._on_socket_close=function(event){this._reconnecting||this._disconnected(g.SOCKET_CLOSE.code,i(g.SOCKET_CLOSE,event!=null?[event.code,event.reason,event.wasClean]:[]))};w.prototype._socket_send=function(a){if(a.type==1){var b=this._traceMask(a,"password");this._trace("Client._socket_send",b)}else this._trace("Client._socket_send",a);this.socket.send(a.encode());this.sendPinger.reset()};w.prototype._receivePublish=function(a){__p&&__p();switch(a.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(a);break;case 1:var b=new l(d.PUBACK,{messageIdentifier:a.messageIdentifier});this._schedule_message(b);this._receiveMessage(a);break;case 2:this._receivedMessages[a.messageIdentifier]=a;this.store("Received:",a);b=new l(d.PUBREC,{messageIdentifier:a.messageIdentifier});this._schedule_message(b);break;default:throw Error("Invaild qos="+wireMmessage.payloadMessage.qos)}};w.prototype._receiveMessage=function(a){this.onMessageArrived&&this.onMessageArrived(a.payloadMessage)};w.prototype._connected=function(a,b){this.onConnected&&this.onConnected(a,b)};w.prototype._reconnect=function(){this._trace("Client._reconnect"),this.connected||(this._reconnecting=!0,this.sendPinger.cancel(),this.receivePinger.cancel(),this._reconnectInterval<128&&(this._reconnectInterval=this._reconnectInterval*2),this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri))};w.prototype._disconnected=function(a,b,c){__p&&__p();this._trace("Client._disconnected",a,b);if(a!==undefined&&this._reconnecting){this._reconnectTimeout=new v(this,window,this._reconnectInterval,this._reconnect);return}this.sendPinger.cancel();this.receivePinger.cancel();this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null);this._msg_queue=[];this._buffered_msg_queue=[];this._notify_msg_sent={};this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.readyState===1&&this.socket.close(),delete this.socket);if(this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1)this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex]);else{a===undefined&&(a=g.OK.code,b=i(g.OK));if(this.connected){this.connected=!1;this.onConnectionLost&&this.onConnectionLost({errorCode:a,errorMessage:b,reconnect:this.connectOptions.reconnect,uri:this._wsuri});if(a!==g.OK.code&&this.connectOptions.reconnect){this._reconnectInterval=1;this._reconnect();return}}else this.connectOptions.mqttVersion===4&&this.connectOptions.mqttVersionExplicit===!1?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:a,errorMessage:b,connack:c})}};w.prototype._trace=function(){if(this.traceFunction){for(var a in arguments)typeof arguments[a]!=="undefined"&&arguments.splice(a,1,JSON.stringify(arguments[a]));var b=Array.prototype.slice.call(arguments).join("");this.traceFunction({severity:"Debug",message:b})}if(this._traceBuffer!==null)for(var a=0,c=arguments.length;a<c;a++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),a===0?this._traceBuffer.push(arguments[a]):typeof arguments[a]==="undefined"?this._traceBuffer.push(arguments[a]):this._traceBuffer.push("  "+JSON.stringify(arguments[a]))};w.prototype._traceMask=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(d==b?c[d]="******":c[d]=a[d]);return c};var x=function(a,b,c,d){__p&&__p();var f;if(typeof a!=="string")throw new Error(i(g.INVALID_TYPE,[typeof a,"host"]));if(arguments.length==2){d=b;f=a;var h=f.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(h)a=h[4]||h[2],b=parseInt(h[7]),c=h[8];else throw new Error(i(g.INVALID_ARGUMENT,[a,"host"]))}else{arguments.length==3&&(d=c,c="/mqtt");if(typeof b!=="number"||b<0)throw new Error(i(g.INVALID_TYPE,[typeof b,"port"]));if(typeof c!=="string")throw new Error(i(g.INVALID_TYPE,[typeof c,"path"]));var j=a.indexOf(":")!==-1&&a.slice(0,1)!=="["&&a.slice(-1)!=="]";f="ws://"+(j?"["+a+"]":a)+":"+b+c}var k=0;for(var l=0;l<d.length;l++){var m=d.charCodeAt(l);55296<=m&&m<=56319&&l++;k++}if(typeof d!=="string"||k>65535)throw new Error(i(g.INVALID_ARGUMENT,[d,"clientId"]));var n=new w(f,a,b,c,d);this._getHost=function(){return a};this._setHost=function(){throw new Error(i(g.UNSUPPORTED_OPERATION))};this._getPort=function(){return b};this._setPort=function(){throw new Error(i(g.UNSUPPORTED_OPERATION))};this._getPath=function(){return c};this._setPath=function(){throw new Error(i(g.UNSUPPORTED_OPERATION))};this._getURI=function(){return f};this._setURI=function(){throw new Error(i(g.UNSUPPORTED_OPERATION))};this._getClientId=function(){return n.clientId};this._setClientId=function(){throw new Error(i(g.UNSUPPORTED_OPERATION))};this._getOnConnected=function(){return n.onConnected};this._setOnConnected=function(a){if(typeof a==="function")n.onConnected=a;else throw new Error(i(g.INVALID_TYPE,[typeof a,"onConnected"]))};this._getDisconnectedPublishing=function(){return n.disconnectedPublishing};this._setDisconnectedPublishing=function(a){n.disconnectedPublishing=a};this._getDisconnectedBufferSize=function(){return n.disconnectedBufferSize};this._setDisconnectedBufferSize=function(a){n.disconnectedBufferSize=a};this._getConnectOptions=function(){return n.connectOptions};this._getOnConnectionLost=function(){return n.onConnectionLost};this._setOnConnectionLost=function(a){if(typeof a==="function")n.onConnectionLost=a;else throw new Error(i(g.INVALID_TYPE,[typeof a,"onConnectionLost"]))};this._getOnMessageDelivered=function(){return n.onMessageDelivered};this._setOnMessageDelivered=function(a){if(typeof a==="function")n.onMessageDelivered=a;else throw new Error(i(g.INVALID_TYPE,[typeof a,"onMessageDelivered"]))};this._getOnMessageArrived=function(){return n.onMessageArrived};this._setOnMessageArrived=function(a){if(typeof a==="function")n.onMessageArrived=a;else throw new Error(i(g.INVALID_TYPE,[typeof a,"onMessageArrived"]))};this._getTrace=function(){return n.traceFunction};this._setTrace=function(a){if(typeof a==="function")n.traceFunction=a;else throw new Error(i(g.INVALID_TYPE,[typeof a,"onTrace"]))};this.connect=function(d){__p&&__p();d=d||{};e(d,{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",onSocketOpen:"function",onSocketError:"function",hosts:"object",ports:"object",reconnect:"boolean",mqttVersion:"number",mqttVersionExplicit:"boolean",ignoreSubProtocol:"boolean",uris:"object"});d.keepAliveInterval===undefined&&(d.keepAliveInterval=60);if(d.mqttVersion>4||d.mqttVersion<3)throw new Error(i(g.INVALID_ARGUMENT,[d.mqttVersion,"connectOptions.mqttVersion"]));d.mqttVersion===undefined?(d.mqttVersionExplicit=!1,d.mqttVersion=4):d.mqttVersionExplicit=!0;if(d.password!==undefined&&d.userName===undefined)throw new Error(i(g.INVALID_ARGUMENT,[d.password,"connectOptions.password"]));if(d.willMessage){if(!(d.willMessage instanceof y))throw new Error(i(g.INVALID_TYPE,[d.willMessage,"connectOptions.willMessage"]));d.willMessage.stringPayload=null;if(typeof d.willMessage.destinationName==="undefined")throw new Error(i(g.INVALID_TYPE,[typeof d.willMessage.destinationName,"connectOptions.willMessage.destinationName"]))}typeof d.cleanSession==="undefined"&&(d.cleanSession=!0);if(d.hosts){if(!(d.hosts instanceof Array))throw new Error(i(g.INVALID_ARGUMENT,[d.hosts,"connectOptions.hosts"]));if(d.hosts.length<1)throw new Error(i(g.INVALID_ARGUMENT,[d.hosts,"connectOptions.hosts"]));var h=!1;for(var b=0;b<d.hosts.length;b++){if(typeof d.hosts[b]!=="string")throw new Error(i(g.INVALID_TYPE,[typeof d.hosts[b],"connectOptions.hosts["+b+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(d.hosts[b])){if(b===0)h=!0;else if(!h)throw new Error(i(g.INVALID_ARGUMENT,[d.hosts[b],"connectOptions.hosts["+b+"]"]))}else if(h)throw new Error(i(g.INVALID_ARGUMENT,[d.hosts[b],"connectOptions.hosts["+b+"]"]))}if(!h){if(!d.ports)throw new Error(i(g.INVALID_ARGUMENT,[d.ports,"connectOptions.ports"]));if(!(d.ports instanceof Array))throw new Error(i(g.INVALID_ARGUMENT,[d.ports,"connectOptions.ports"]));if(d.hosts.length!==d.ports.length)throw new Error(i(g.INVALID_ARGUMENT,[d.ports,"connectOptions.ports"]));d.uris=[];for(var b=0;b<d.hosts.length;b++){if(typeof d.ports[b]!=="number"||d.ports[b]<0)throw new Error(i(g.INVALID_TYPE,[typeof d.ports[b],"connectOptions.ports["+b+"]"]));h=d.hosts[b];var a=d.ports[b],j=h.indexOf(":")!==-1;f="ws://"+(j?"["+h+"]":h)+":"+a+c;d.uris.push(f)}}else d.uris=d.hosts}n.connect(d)};this.subscribe=function(a,b){if(typeof a!=="string")throw new Error("Invalid argument:"+a);b=b||{};e(b,{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"});if(b.timeout&&!b.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if(typeof b.qos!=="undefined"&&!(b.qos===0||b.qos===1||b.qos===2))throw new Error(i(g.INVALID_ARGUMENT,[b.qos,"subscribeOptions.qos"]));n.subscribe(a,b)};this.unsubscribe=function(a,b){if(typeof a!=="string")throw new Error("Invalid argument:"+a);b=b||{};e(b,{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"});if(b.timeout&&!b.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");n.unsubscribe(a,b)};this.send=function(a,b,c,d){__p&&__p();var e;if(arguments.length===0)throw new Error("Invalid argument.length");else if(arguments.length==1){if(!(a instanceof y)&&typeof a!=="string")throw new Error("Invalid argument:"+typeof a);e=a;if(typeof e.destinationName==="undefined")throw new Error(i(g.INVALID_ARGUMENT,[e.destinationName,"Message.destinationName"]));n.send(e)}else e=new y(b),e.destinationName=a,arguments.length>=3&&(e.qos=c),arguments.length>=4&&(e.retained=d),n.send(e)};this.publish=function(a,b,c,d){__p&&__p();!1;var e;if(arguments.length===0)throw new Error("Invalid argument.length");else if(arguments.length==1){if(!(a instanceof y)&&typeof a!=="string")throw new Error("Invalid argument:"+typeof a);e=a;if(typeof e.destinationName==="undefined")throw new Error(i(g.INVALID_ARGUMENT,[e.destinationName,"Message.destinationName"]));return n.send(e)}else{e=new y(b);e.destinationName=a;arguments.length>=3&&(e.qos=c);arguments.length>=4&&(e.retained=d);return n.send(e)}};this.disconnect=function(){n.disconnect()};this.getTraceLog=function(){return n.getTraceLog()};this.startTrace=function(){n.startTrace()};this.stopTrace=function(){n.stopTrace()};this.isConnected=function(){return n.connected}};Object.defineProperties(x.prototype,{host:{get:function(){return this._getHost()},set:function(a){this._setHost(a)}},port:{get:function(){return this._getPort()},set:function(a){this._setPort(a)}},path:{get:function(){return this._getPath()},set:function(a){this._setPath(a)}},clientId:{get:function(){return this._getClientId()},set:function(a){this._setClientId(a)}},onConnected:{get:function(){return this._getOnConnected()},set:function(a){this._setOnConnected(a)}},disconnectedPublishing:{get:function(){return this._getDisconnectedPublishing()},set:function(a){this._setDisconnectedPublishing(a)}},disconnectedBufferSize:{get:function(){return this._getDisconnectedBufferSize()},set:function(a){this._setDisconnectedBufferSize(a)}},onConnectionLost:{get:function(){return this._getOnConnectionLost()},set:function(a){this._setOnConnectionLost(a)}},connectOptions:{get:function(){return this._getConnectOptions()}},onMessageDelivered:{get:function(){return this._getOnMessageDelivered()},set:function(a){this._setOnMessageDelivered(a)}},onMessageArrived:{get:function(){return this._getOnMessageArrived()},set:function(a){this._setOnMessageArrived(a)}},trace:{get:function(){return this._getTrace()},set:function(a){this._setTrace(a)}}});var y=function(a){__p&&__p();var b;if(typeof a==="string"||a instanceof ArrayBuffer||a instanceof Int8Array||a instanceof Uint8Array||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array)b=a;else throw i(g.INVALID_ARGUMENT,[a,"newPayload"]);this._getPayloadString=function(){if(typeof b==="string")return b;else return t(b,0,b.length)};this._getPayloadBytes=function(){if(typeof b==="string"){var a=new ArrayBuffer(r(b));a=new Uint8Array(a);s(b,a,0);return a}else return b};var c;this._getDestinationName=function(){return c};this._setDestinationName=function(a){if(typeof a==="string")c=a;else throw new Error(i(g.INVALID_ARGUMENT,[a,"newDestinationName"]))};var d=0;this._getQos=function(){return d};this._setQos=function(a){if(a===0||a===1||a===2)d=a;else throw new Error("Invalid argument:"+a)};var e=!1;this._getRetained=function(){return e};this._setRetained=function(a){if(typeof a==="boolean")e=a;else throw new Error(i(g.INVALID_ARGUMENT,[a,"newRetained"]))};var f=!1;this._getDuplicate=function(){return f};this._setDuplicate=function(a){f=a}};Object.defineProperties(y.prototype,{payloadString:{get:function(){return this._getPayloadString()}},payloadBytes:{get:function(){return this._getPayloadBytes()}},destinationName:{get:function(){return this._getDestinationName()},set:function(a){this._setDestinationName(a)}},topic:{get:function(){return this._getDestinationName()},set:function(a){this._setDestinationName(a)}},qos:{get:function(){return this._getQos()},set:function(a){this._setQos(a)}},retained:{get:function(){return this._getRetained()},set:function(a){this._setRetained(a)}},duplicate:{get:function(){return this._getDuplicate()},set:function(a){this._setDuplicate(a)}}});return{TESTING_CLIENT_IMPL:w,Client:x,Message:y}}(window);return b})}),null);
__d("MqttConnection",["Promise","MqttLogger","Random","gkx","paho-mqtt"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=30,h="publish",i="subscribe",j="unsubscribe",k=function(a){},l=18e4,m=21,n=new Set(["AMQJS0007E"]);function o(a){return a?a.split(" ")[0]:""}function a(){this.$7=!1,this.$10=b("MqttLogger").getInstance(),this.$11="Disconnected",this.$16=new Set(),this.$18=[],this.$19=new Map()}a.prototype.run=function(a){__p&&__p();var b=a.onStateChange,c=a.onError,d=a.onJSError,e=a.onMessageReceived,f=a.endpoint,g=a.deviceId,h=a.userFbid,i=a.appId,j=a.subscribedTopics;a=a.capabilities;if(this.$7){this.$10.debugTrace("run","Run called while in running state.");return}this.$1=b;this.$2=c;this.$4=e;this.$5=f;this.$9=g;this.$12=h;this.$15=i;this.$7=!0;this.$13=0;this.$17=a;this.$3=d||k;j&&j.forEach(function(a){return this.$16.add(a)}.bind(this));this.$20()};a.prototype.shutdown=function(){this.$21(),this.$7=!1,this.$10.debugTrace("shutdown","Shutdown")};a.prototype.subscribe=function(a){this.$16.add(a);if(!this.$22(i))return b("gkx")("676932");try{this.$6.subscribe(a,{})}catch(b){this.$10.logError(b,"Exception subscribing"),this.$10.bumpCounter("subscribe_exception."+a)}this.$10.debugTrace("subscribe","Subscribing to "+a);return!0};a.prototype.publish=function(a,c,d){__p&&__p();var e={resolve:function(){},reject:function(a){}},f=new(b("Promise"))(function(a,b){e.resolve=a,e.reject=b}),g=this.$22(h),i;if(!this.$7||!g)this.$18.push({topic:a,payload:c,qos:d,ack:e}),i="buffered";else{try{c=this.$6.publish(a,c,d,!1);c!=null?this.$19.set(c,e):e.resolve()}catch(b){this.$10.logError(b,"Exception publishing"),this.$10.bumpCounter("publish_exception."+a),e.reject(b)}i="published"}this.$10.logPublish({sessionID:this.$8,topic:a,connectionStatus:g,publishStatus:i});return f};a.prototype.unsubscribe=function(a){this.$16["delete"](a);if(!this.$22(j))return!1;try{this.$6.unsubscribe(a,{})}catch(b){this.$10.logError(b,"Exception unsubscribing"),this.$10.bumpCounter("unsubscribe_exception."+a)}this.$10.debugTrace("unsubscribe","Unsubscribing to "+a);return!0};a.prototype.isRunning=function(){return this.$7};a.prototype.$21=function(){this.$7&&this.$6&&(this.$23("Disconnected"),this.$6.onMessageArrived=k,this.$6.onMessageDelivered=k,this.$6.onConnectionLost=k,this.$6.connectOptions&&(this.$6.connectOptions.onSuccess=k,this.$6.connectOptions.onFailure=k,b("gkx")("676933")||(this.$6.connectOptions.onSocketOpen=k,this.$6.connectOptions.onSocketError=k)),this.$6.isConnected()&&this.$6.disconnect(),this.$6=null)};a.prototype.$23=function(a){a!==this.$11&&(this.$11=a,this.$1(a))};a.prototype.$20=function(){__p&&__p();if(!this.$7)return;this.$23("Connecting");var a=Date.now(),c=Array.from(this.$16);try{this.$6=new(b("paho-mqtt").Client)(this.$5,"mqttwsclient");this.$8=this.$24();var d=Date.now();this.$6.onConnectionLost=function(a){a.errorCode&&this.$10.logDisconnect({sessionID:this.$8,errorCode:a.errorCode,errorMessage:a.errorMessage,duration:Date.now()-this.$14}),this.$25()}.bind(this);this.$6.onMessageArrived=function(a){var b=a.destinationName;this.$10.debugTrace("onMessageArrived","Message received on "+b);this.$10.bumpCounter("message_arrived."+b);try{this.$4(a.destinationName,a.payloadString)}catch(a){this.$10.logError(a,"Unable to parse messaging"),this.$10.bumpCounter("error_processing_message."+b)}}.bind(this);this.$6.onMessageDelivered=function(a,b){this.$26(a,b)}.bind(this);this.$6.connect({userName:JSON.stringify({u:this.$12,s:this.$8,cp:1,ecp:this.$17,chat_on:!0,fg:1,d:this.$27(),ct:"websocket",mqtt_sid:"",aid:this.$15,st:c,dc:""}),mqttVersion:3,password:"",keepAliveInterval:g,onFailure:function(a){__p&&__p();this.$10.debugTrace("connect","Connect failed "+a.errorMessage);if(n.has(o(a.errorMessage))){this.$10.debugTrace("abort","Aborting because "+a.errorCode+" is unretryable");return this.$28(new Error(a.errorMessage))}this.$29(!1,Date.now()-d,c,a.errorCode,a.errorMessage);if(a&&a.connack){this.$10.bumpCounter("connect_failure."+a.connack);if(a.connack===m){this.$25(l);return}}this.$25()}.bind(this),onSuccess:function(){this.$10.debugTrace("connect","Connect success"),this.$29(!0,Date.now()-d,c),this.$23("Connected"),this.$13=0,this.$14=Date.now(),this.$18=[]}.bind(this),ignoreSubProtocol:!0,onSocketOpen:function(){return this.$30()}.bind(this),onSocketError:function(a){this.$10.bumpCounter("js_error_in_socket"),b("gkx")("676934")?this.$10.bumpCounter("js_error_no_fallback"):this.$28(a)}.bind(this)})}catch(b){this.$10.bumpCounter("js_error_in_init_exception"),this.$23("Disconnected"),this.$29(!1,Date.now()-a,c,14,b.message),b&&this.$10.logErrorWarn(b,"socket error"),this.$28(b)}};a.prototype.$30=function(){this.$18.forEach(function(a){if(this.$6){var b=this.$6.publish(a.topic,a.payload,a.qos);b!=null?this.$19.set(b,a.ack):a.ack.resolve()}}.bind(this))};a.prototype.$25=function(a){__p&&__p();a===void 0&&(a=null);if(!this.$7)return;this.$21();this.$8=-1;a=(a=a)!=null?a:Math.pow(2,Math.min(this.$13,6))*(1e3+Math.random()*200);this.$10.debugTrace("_scheduleReconnect","Reconnect in "+a+" ms");setTimeout(function(){this.$20()}.bind(this),a);this.$13+=1};a.prototype.$24=function(){return Math.floor(b("Random").random()*Number.MAX_SAFE_INTEGER)};a.prototype.$27=function(){return this.$9};a.prototype.$22=function(a){__p&&__p();if(!this.$7){this.$10.debugTrace("_ensureConnected","Mqtt connection: "+a+" called when not running");return!1}if(this.$6==null){this.$10.debugTrace("_ensureConnected","Mqtt connection: "+a+" called when not connected, ignored");return!1}if(this.$11!=="Connected"){this.$10.debugTrace("_ensureConnected","Mqtt connection: "+a+" called with connection state "+this.$11);return!1}var b=this.$6.isConnected();if(!b){this.$10.debugTrace("_ensureConnected","Mqtt connection: "+a+" called with client connection state "+b);return!1}return!0};a.prototype.$29=function(a,b,c,d,e){this.$10.logConnect({sessionID:this.$8,connectionStatus:a,duration:Date.now()-b,hostname:this.$5,attemptNumber:this.$13,subscribedTopics:c,errorCode:d,errorMessage:e})};a.prototype.$26=function(a,b){a=b!=null?b:"null";this.$10.debugTrace("onMessageDelivered","Delivered Message {ID: "+a+"}");if(b==null)return;a=this.$19.get(b);if(a==null)return;this.$19["delete"](b);a.resolve()};a.prototype.$28=function(a){try{this.$10.bumpCounter("js_error_in_init");var c=a?a.message:"socket error";this.$10.debugTrace("onSocketError",c)}catch(a){this.$10.bumpCounter("js_error_in_init_logging"),this.$10.logError(a,"JS error while trying to log previous JS error")}b("gkx")("676935")&&this.$13<8?this.$25():(this.$10.bumpCounter("js_error_falling_back"),this.$3(a))};e.exports=a}),null);
__d("MqttChannel",["MqttConnection","MqttLogger","uuid"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){__p&&__p();var c=a.endpoint,d=a.userFbid,e=a.appId,f=a.initialSubscribedTopics;a=a.capabilities;this.$8=b("MqttLogger").getInstance();this.$8.setAppId(e);this.$9=e;this.$10=d;this.$1=c;this.$3="Disconnected";this.$2=[];this.$4=new Map();this.$7=new(b("MqttConnection"))();this.$5=b("uuid")();this.$6=new Set();this.$11(f,a)}a.prototype.$11=function(a,b){if(this.$7.isRunning()){this.$12("run","Connection started calling run again");return}this.$7.run({onStateChange:function(a){this.$13(a)}.bind(this),onError:function(a){this.$8.debugTrace("connection","Error "+a)}.bind(this),onJSError:function(a){this.$14(a)}.bind(this),onMessageReceived:function(a,b){this.$15(a,b)}.bind(this),deviceId:this.$5,endpoint:this.$1,userFbid:this.$10,appId:this.$9,subscribedTopics:a,capabilities:b})};a.prototype.shutdown=function(){this.$7&&this.$7.shutdown()};a.prototype.publish=function(a,b){return this.$7.publish(a,b,1)};a.prototype.subscribe=function(a,b){this.$7.subscribe(a)||this.$6.add(a);var c=this.$4.get(a);!c?(c=[b],this.$4.set(a,c)):c.push(b)};a.prototype.subscribeChannelEvents=function(a){this.$2.push(a)};a.prototype.unsubscribe=function(a){this.$7.unsubscribe(a)||this.$6["delete"](a),this.$4["delete"](a)};a.prototype.getDeviceId=function(){return this.$5};a.prototype.getConnectionState=function(){return this.$3};a.prototype.getEndpoint=function(){return this.$1};a.prototype.testOnlyResetState=function(){this.$1="",this.$2=[],this.$3="Disconnected",this.$4=new Map(),this.$8=b("MqttLogger").getInstance(),this.$7=new(b("MqttConnection"))(),this.$5=b("uuid")(),this.$6=new Set()};a.prototype.testOnlyMessageReceived=function(a,b){this.$15(a,b)};a.prototype.$15=function(a,b){__p&&__p();var c=this.$4.get(a);if(!c)this.$8.debugTrace("_onMessageReceived",a+" being dropped, no listeners");else for(var a=c,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;try{e(b)}catch(a){this.$8.logError(a,"Listener exception"),this.$8.bumpCounter("listener_error")}}};a.prototype.$14=function(a){__p&&__p();for(var b=this.$2,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;e.onJSError&&e.onJSError(a)}};a.prototype.$13=function(a){this.$3!=="Connected"&&a==="Connected"&&(this.$6.forEach(function(a){return this.$7.subscribe(a)}.bind(this)),this.$6.clear()),this.$3=a,this.$12("_changeState","Connection state = "+a),this.$16(a)};a.prototype.$16=function(a){__p&&__p();for(var b=this.$2,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;e.onMQTTStateChanged(a)}};a.prototype.$12=function(event,a){this.$8.debugTrace(event,"Mqtt channel: "+a)};e.exports=a}),null);
__d("LiveChatMqttClient",["Arbiter","ChannelConstants","LiveChatPluginConstants","LiveChatPluginLocalStorageUtil","LiveChatPluginLoggerUtil","MercurySingletonProvider","MessageEventStream","MessengerLiveChatPluginEvent","MessengerLiveChatPluginTypedLogger","MessengerMQTTConnectionEvents","MessengerMQTTGating","MqttChannel","Network"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=225396507985893,h="n",i="wss://edge-chat.facebook.com/chat";function j(a){this.$1=a}j.getForFBID=function(a){return k.getForFBID(a)};j.setUp=function(a,b,c,d){var e=j.getForFBID(b);e.init(a,b,c,d)};j.prototype.init=function(a,c,d,e){__p&&__p();this.$2=a;this.$3=new(b("MqttChannel"))({endpoint:i,userFbid:c,appId:g,initialSubscribedTopics:["/t_ms"],capabilities:0});a={thread_filter:[{other_user_fbid:a}]};!d?b("MessageEventStream").getForFBID(c).init(this.$3,null,a,h).addDeltaStreamListener(this):b("MessageEventStream").getForFBID(c).init(this.$3,d,a).addDeltaStreamListener(this);new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(this.$1).setPageID(this.$2).setRequestID(b("LiveChatPluginLocalStorageUtil").getRequestID()).setEvent(b("MessengerLiveChatPluginEvent").MQTT_CONNECTION_INITIATED).setEventTimestamp(Date.now()).log();this.$3.subscribeChannelEvents({onMQTTStateChanged:function(a){a===b("LiveChatPluginConstants").CONNECTED_STATE&&(e&&e()),(b("Network").isOnline()||a!=="Connecting")&&b("Arbiter").inform(b("LiveChatPluginConstants").STATE_UPDATE,a),new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(this.$1).setPageID(this.$2).setRequestID(b("LiveChatPluginLocalStorageUtil").getRequestID()).setEvent(b("MessengerLiveChatPluginEvent").MQTT_CONNECTION_STATE_CHANGED).setDebugData(a).setEventTimestamp(Date.now()).log()}.bind(this)});b("Network").addListener("offline",function(){this.$3.getConnectionState()===b("LiveChatPluginConstants").CONNECTED_STATE&&b("Arbiter").inform(b("LiveChatPluginConstants").STATE_UPDATE,b("LiveChatPluginConstants").DISCONNECTED_STATE)}.bind(this));b("Network").addListener("online",function(){this.$3.getConnectionState()===b("LiveChatPluginConstants").CONNECTED_STATE&&b("Arbiter").inform(b("LiveChatPluginConstants").STATE_UPDATE,b("LiveChatPluginConstants").CONNECTED_STATE)}.bind(this));this.$3.subscribe("/orca_typing_notifications",function(a){b("Arbiter").inform(b("LiveChatPluginConstants").TYPING_UPDATE,JSON.parse(a).state)})};j.prototype.onDeltaReceived=function(a){__p&&__p();var c=a.type;a=a.payload;try{c=c.replace(/^delta/,"unknown");var d=Number(a.irisSeqId);a={delta:babelHelpers["extends"]({},a,{"class":c}),iseq:d,type:"delta"};var e=b("MessengerMQTTGating").isEnabled()?b("MessengerMQTTConnectionEvents").DELTA_EVENT:b("ChannelConstants").getArbiterType("delta");b("Arbiter").inform(e,{obj:a});b("LiveChatPluginLoggerUtil").logDelta(this.$1,this.$2,c,d)}catch(a){new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(this.$1).setPageID(this.$2).setRequestID(b("LiveChatPluginLocalStorageUtil").getRequestID()).setEvent(b("MessengerLiveChatPluginEvent").DELTA_PARSING_ERROR).setEventTimestamp(Date.now()).logVital()}};j.prototype.onStreamDisconnect=function(a){};var k=new(b("MercurySingletonProvider"))(j);e.exports=j}),null);
__d("LiveChatPluginCloseButtonSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("svg",{width:"10px",height:"10px",viewBox:"0 0 14 14"},b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},b("React").createElement("g",{transform:"translate(-419.000000, -413.000000)"},b("React").createElement("g",{transform:"translate(164.000000, 396.000000)"},b("React").createElement("g",null,b("React").createElement("g",{transform:"translate(250.000000, 12.000000)"},b("React").createElement("g",null,b("React").createElement("g",null,b("React").createElement("rect",{opacity:"0.200000003",x:"0",y:"0",width:"24",height:"24"}),b("React").createElement("g",{transform:"translate(4.000000, 4.000000)",fill:"#000000"},b("React").createElement("rect",{transform:"translate(8.000000, 8.000000) rotate(45.000000) translate(-8.000000, -8.000000) ",x:"7",y:"-1",width:"2",height:"18",rx:"1"}),b("React").createElement("rect",{transform:"translate(8.000000, 8.000000) rotate(135.000000) translate(-8.000000, -8.000000) ",x:"7",y:"-1",width:"2",height:"18",rx:"1"}))))))))))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginFbts",["fbt"],(function(a,b,c,d,e,f,g){"use strict";a={DEFAULT_LOGGED_IN_GREETING_TEXT:g._("Hi! How can we help you?"),DEFAULT_LOGGED_OUT_GREETING_TEXT:g._("Hi! We're here to answer any questions you may have.")};e.exports=a}),null);
__d("PrivacyTransparentOverlay.react",["cx","React"],(function(a,b,c,d,e,f,g){"use strict";var h;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_4cqr"},this.props.children,b("React").createElement("div",{className:"clearfix"}))};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginAnonymousUserPrompt.react",["cx","fbt","Image.react","Link.react","LiveChatPluginCloseButtonSVG.react","LiveChatPluginFbts","LiveChatPluginLoggerUtil","MessengerLiveChatPluginEvent","MessengerTextWithEntities.react","PluginOptin","PrivacyTransparentOverlay.react","React","ReactDOM","ShimButton.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=124,k=24,l=24,m=10;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$2=function(){this.$4(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").LOG_IN_TO_MESSENGER_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$3=function(){this.$4(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").CHAT_NOW_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),c}a.prototype.componentDidMount=function(){this.$1(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").ANONYMOUS_CHAT_NOW_PROMPT_RENDERED,this.props.viewerID,this.props.pageID)};a.prototype.componentDidUpdate=function(){this.$1()};a.prototype.render=function(){return b("React").createElement("div",{className:"_j68"},b("React").createElement("div",{className:"promptHeaderContainer"},b("React").createElement("div",{className:"promptTextContainer"},b("React").createElement("div",{className:"promptHeader",ref:"promptHeader"},this.props.loggedOutGreeting?b("React").createElement(b("MessengerTextWithEntities.react"),{renderEmoji:!0,renderEmoticons:!0,text:this.props.loggedOutGreeting}):b("LiveChatPluginFbts").DEFAULT_LOGGED_OUT_GREETING_TEXT),b("React").createElement("div",{className:"promptSubheader",ref:"promptSubheader"},b("React").createElement(b("Link.react"),{className:"notYouLink",onClick:this.$2},h._("Log in to Messenger to chat.")))),b("React").createElement(b("PrivacyTransparentOverlay.react"),null,b("React").createElement(b("Image.react"),{className:"profilePicture",src:this.props.pageProfilePictureUri})),b("React").createElement("div",{className:"closeButtonContainer"},b("React").createElement(b("ShimButton.react"),{className:"_4bqf _2t-5",onClick:this.props.onCloseButtonClick},b("React").createElement(b("LiveChatPluginCloseButtonSVG.react"),null)))),b("React").createElement("div",{className:"promptButtonContainer",ref:"promptButtonContainer"},b("React").createElement(b("ShimButton.react"),{className:"_4bqf promptButton",onClick:this.$3,style:{color:this.props.threadColor}},h._("Chat"))))};a.prototype.$4=function(){new(b("PluginOptin"))("customer_chat").addLoginParams({logged_in:!1,page_id:this.props.pageID,switch_user:!1}).addReturnParams({customer_chat_origin_uri:this.props.refererUri,referer_uri:this.props.refererUri}).start()};a.prototype.$1=function(){var a=b("ReactDOM").findDOMNode(this.refs.promptHeader),c=b("ReactDOM").findDOMNode(this.refs.promptSubheader),d=b("ReactDOM").findDOMNode(this.refs.promptButtonContainer);if(a instanceof HTMLElement&&c instanceof HTMLElement&&d instanceof HTMLElement){a=a.offsetHeight+c.offsetHeight+d.offsetHeight+l+m;c=a>j?a:j;this.props.anchorIframeResizeFn(c+k,c)}};e.exports=a}),null);
__d("LiveChatPluginInformationButtonSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24"},b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},b("React").createElement("g",{transform:"translate(-413.000000, -56.000000)"},b("React").createElement("g",{transform:"translate(90.000000, 44.000000)"},b("React").createElement("g",null,b("React").createElement("g",null,b("React").createElement("g",{transform:"translate(324.000000, 13.000000)"},b("React").createElement("circle",{fill:this.props.informationViewOpen?this.props.threadColor:"#FFFFFF",stroke:this.props.threadColor,cx:"11",cy:"11",r:"11"}),b("React").createElement("path",{d:"M11,9 L12,9 L12,17 L13,17 L13,17.5 L9,17.5 L9,17 L10,17 L10,9.5 L9,9.5 L9,9 L11,9 Z M11,4.5 C11.8284271,4.5 12.5,5.17157288 12.5,6 C12.5,6.82842712 11.8284271,7.5 11,7.5 C10.1715729,7.5 9.5,6.82842712 9.5,6 C9.5,5.17157288 10.1715729,4.5 11,4.5 Z",fill:this.props.informationViewOpen?"#FFFFFF":this.props.threadColor}))))))))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginDialogHeader.react",["cx","LineClamp.react","LiveChatPluginCloseButtonSVG.react","LiveChatPluginInformationButtonSVG.react","React","ShimButton.react"],(function(a,b,c,d,e,f,g){"use strict";var h;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_f_0"},b("React").createElement("div",{className:"_1qd1"},b("React").createElement(b("ShimButton.react"),{className:"_2t-5 _4bqf",onClick:this.props.onCloseButtonClick},b("React").createElement(b("LiveChatPluginCloseButtonSVG.react"),null))),b("React").createElement("div",{className:"_hov"},b("React").createElement(b("LineClamp.react"),{className:"_how",lines:1},this.props.pageName),b("React").createElement(b("LineClamp.react"),{className:"_hox",lines:1},this.props.pageResponsivenessText)),b("React").createElement("div",{className:"_1qd3"},b("React").createElement(b("ShimButton.react"),{className:"_4bqf _17l7",onClick:this.props.onInformationButtonClick},b("React").createElement(b("LiveChatPluginInformationButtonSVG.react"),{informationViewOpen:this.props.informationViewOpen,threadColor:this.props.threadColor}))))};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginDefaultMessengerIconSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("svg",{x:"0",y:"0",width:"60",height:"60"},b("React").createElement("defs",null,b("React").createElement("linearGradient",{x1:"50%",y1:"100%",x2:"50%",y2:"0.000340050378%",id:"linearGradient-1"},b("React").createElement("stop",{stopColor:"#0068FF",offset:"4.5%"}),b("React").createElement("stop",{stopColor:"#00C6FF",offset:"95.5%"}))),b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},b("React").createElement("g",null,b("React").createElement("g",null,b("React").createElement("circle",{fill:"#FFFFFF",cx:"30",cy:"30",r:"30"}),b("React").createElement("g",{transform:"translate(10.000000, 11.000000)"},b("React").createElement("path",{d:"M0,18.7150914 C0,24.5969773 2.44929143,29.6044708 6.95652174,33.0434783 L6.95652174,40 L14.2544529,36.6459314 C16.0763359,37.1551856 18,37.4301829 20,37.4301829 C31.043257,37.4301829 40,29.0529515 40,18.7150914 C40,8.37723141 31.043257,0 20,0 C8.956743,0 0,8.37723141 0,18.7150914 Z",fill:"url(#linearGradient-1)"}),b("React").createElement("polygon",{fill:"#FFFFFF",points:"16.9378907 19.359375 7 25 17.8976562 13.140625 23.0570312 18.640625 33 13 22.1023437 24.859375"}))))))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("XMNLiveChatConnectController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/plugins/live_chat/connect/",{from_interstitial:{type:"Bool",defaultValue:!1},page_id:{type:"String",required:!0}})}),null);
__d("LiveChatPluginLoggedInMobileInterstitial.react",["cx","fbt","ix","AsyncRequest","CurrentUser","Image.react","LiveChatPluginCloseButtonSVG.react","LiveChatPluginDefaultMessengerIconSVG.react","LiveChatPluginFbts","LiveChatPluginLoggerUtil","MessengerLiveChatPluginEvent","MessengerLiveChatSettings","PluginOptin","React","ShimButton.react","XMNLiveChatConnectController"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=babelHelpers.inherits(a,b("React").Component);j=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=j.constructor).call.apply(a,[this].concat(e)),this.$4=function(){var a=b("XMNLiveChatConnectController").getURIBuilder().setString("page_id",this.props.pageID).getURI();this.$1=new(b("AsyncRequest"))().setURI(a).setMethod("POST").setAllowCrossPageTransition(!0).setHandler(this.props.onChatNowClick);this.$1.send()}.bind(this),this.$5=function(){new(b("PluginOptin"))("customer_chat").addLoginParams({logged_in:!1,page_id:this.props.pageID,switch_user:!0}).addReturnParams({referer_uri:this.props.refererUri}).start(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").NOT_YOU_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$2=function(){this.props.onCloseButtonClick&&(this.props.onCloseButtonClick(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").MOBILE_INTERSTITIAL_CLOSE_CLICKED,this.props.viewerID,this.props.pageID))}.bind(this),c}a.prototype.componentWillUnmount=function(){this.$1&&this.$1.abandon()};a.prototype.render=function(){return b("React").createElement("div",{className:"_6k7_"},b("React").createElement("div",{className:"_6k80"},b("React").createElement(b("ShimButton.react"),{className:"_4bqf _2t-5",onClick:this.$2},b("React").createElement(b("LiveChatPluginCloseButtonSVG.react"),null))),this.$3(),b("React").createElement("div",{className:"_6k81"},b("React").createElement("div",{className:"_6k82"},b("React").createElement(b("LiveChatPluginDefaultMessengerIconSVG.react"),null)),b("React").createElement("div",{className:"_6k83"},h._("{name}'s Chat",[h._param("name",this.props.pageName)]),b("React").createElement("br",null),h._("Powered by Messenger")),b("React").createElement(b("ShimButton.react"),{className:"_6k84",onClick:this.$4},b("React").createElement(b("Image.react"),{className:"_6k85",src:i("86959")}),h._("Continue as {user name}",[h._param("user name",b("CurrentUser").getName())])),b("React").createElement(b("ShimButton.react"),{className:"_6k86",onClick:this.$5},h._("Switch Account"))))};a.prototype.$3=function(){var a;a=(a=b("MessengerLiveChatSettings").qeSettings)!=null?a.showGreetingTextInterstitial:a;return!a?null:b("React").createElement("div",{className:"_6taj"},b("React").createElement("div",{className:"_6i-9"},this.props.pageName),this.props.loggedInGreeting?this.props.loggedInGreeting:b("LiveChatPluginFbts").DEFAULT_LOGGED_IN_GREETING_TEXT)};e.exports=a}),null);
__d("LiveChatPluginLoggedInUserPrompt.react",["cx","fbt","Arbiter","AsyncRequest","CurrentUser","Image.react","Link.react","LiveChatPluginCloseButtonSVG.react","LiveChatPluginFbts","LiveChatPluginLocalStorageUtil","LiveChatPluginLoggerUtil","MessengerLiveChatPluginEvent","MessengerTextWithEntities.react","Plugin","PluginOptin","PrivacyTransparentOverlay.react","React","ReactDOM","ShimButton.react","XMNLiveChatConnectController"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=124,k=24,l=24,m=10;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$4=function(){new(b("PluginOptin"))("customer_chat").addLoginParams({logged_in:!1,page_id:this.props.pageID,switch_user:!0}).addReturnParams({referer_uri:this.props.refererUri}).start(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").NOT_YOU_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$5=function(){__p&&__p();if(!b("CurrentUser").isLoggedInNow())return;if(this.props.hasMessagingPermission)this.props.onChatNowClick();else if(this.props.canSkipContinuousAs||this.props.isFacebookApp){var a=b("XMNLiveChatConnectController").getURIBuilder().setString("page_id",this.props.pageID).getURI();this.$1=new(b("AsyncRequest"))().setURI(a).setMethod("POST").setAllowCrossPageTransition(!0).setHandler(this.props.onChatNowClick);this.$1.send()}else new(b("PluginOptin"))("customer_chat").addLoginParams({logged_in:!0,page_id:this.props.pageID,request_id:b("LiveChatPluginLocalStorageUtil").getRequestID(),switch_user:!1}).start(),b("Arbiter").subscribe(b("Plugin").CONNECT,this.props.onChatNowClick);b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").CHAT_NOW_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),c}a.prototype.componentDidMount=function(){this.$2(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").LOGGED_IN_CHAT_NOW_PROMPT_RENDERED,this.props.viewerID,this.props.pageID,JSON.stringify({hasMessagingPermission:this.props.hasMessagingPermission}))};a.prototype.componentDidUpdate=function(){this.$2()};a.prototype.componentWillUnmount=function(){this.$1&&this.$1.abandon()};a.prototype.render=function(){return b("React").createElement("div",{className:"_j68"},b("React").createElement("div",{className:"promptHeaderContainer"},b("React").createElement("div",{className:"promptTextContainer"},b("React").createElement("div",{className:"promptHeader",ref:"promptHeader"},this.$3()),b("React").createElement("div",{className:"promptSubheader"},b("React").createElement("div",{className:"profilePictureContainer"},b("React").createElement(b("PrivacyTransparentOverlay.react"),null,b("React").createElement(b("Image.react"),{className:"profilePicture",src:this.props.viewerProfilePictureUri}))),b("React").createElement("div",{ref:"promptSubheader"},b("React").createElement("div",{className:"username"},b("CurrentUser").getName()),b("React").createElement(b("Link.react"),{className:"notYouLink",onClick:this.$4},h._("Not you?"))))),b("React").createElement(b("PrivacyTransparentOverlay.react"),null,b("React").createElement(b("Image.react"),{className:"profilePicture",src:this.props.pageProfilePictureUri})),b("React").createElement("div",{className:"closeButtonContainer"},b("React").createElement(b("ShimButton.react"),{className:"_4bqf _2t-5",onClick:this.props.onCloseButtonClick},b("React").createElement(b("LiveChatPluginCloseButtonSVG.react"),null)))),b("React").createElement("div",{className:"fillerDiv"}),b("React").createElement("div",{className:"promptButtonContainer",ref:"promptButtonContainer"},b("React").createElement(b("ShimButton.react"),{className:"_4bqf promptButton",onClick:this.$5,style:{color:this.props.threadColor}},h._("Chat Now"))))};a.prototype.$3=function(){if(this.props.loggedInGreeting)return b("React").createElement(b("MessengerTextWithEntities.react"),{renderEmoji:!0,renderEmoticons:!0,text:this.props.loggedInGreeting});else return b("React").createElement("div",null,b("LiveChatPluginFbts").DEFAULT_LOGGED_IN_GREETING_TEXT)};a.prototype.$2=function(){var a=b("ReactDOM").findDOMNode(this.refs.promptHeader),c=b("ReactDOM").findDOMNode(this.refs.promptSubheader),d=b("ReactDOM").findDOMNode(this.refs.promptButtonContainer);if(a instanceof HTMLElement&&c instanceof HTMLElement&&d instanceof HTMLElement){a=a.offsetHeight+c.offsetHeight+d.offsetHeight+l+m;c=Math.max(a,j);this.props.anchorIframeResizeFn(c+k,c)}};e.exports=a}),null);
__d("AbstractTextInput.react",["cx","AbstractTextField.react","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").Component;h=babelHelpers.inherits(a,c);h&&h.prototype;a.prototype.render=function(){"use strict";return b("React").createElement(b("AbstractTextField.react"),this.props,b("React").createElement("input",{className:"_58al",onClick:this.props.onClick,onMouseDown:this.props.onMouseDown,onKeyUp:this.props.onKeyUp,onKeyDown:this.props.onKeyDown,onPaste:this.props.onPaste,size:this.props.size,tabIndex:this.props.tabIndex,type:this.props.type,ref:function(a){return this.$1=a}.bind(this)}))};a.prototype.focusInput=function(){"use strict";this.$1&&this.$1.focus()};a.prototype.blurInput=function(){"use strict";this.$1&&this.$1.blur()};a.prototype.selectInput=function(){"use strict";this.$1&&this.$1.select()};a.prototype.getTextFieldDOM=function(){"use strict";return this.$1};a.prototype.getValue=function(){"use strict";return this.$1?this.$1.value:""};function a(){"use strict";h.apply(this,arguments)}a.propTypes=b("AbstractTextField.react").propTypes;a.defaultProps={type:"text"};e.exports=a}),null);
__d("LiveChatPluginAttachmentUploadError",["keyMirror"],(function(a,b,c,d,e,f){"use strict";a=Object.freeze(b("keyMirror")({NO_ERROR:"",UPLOAD_FAILED:"",EXCEEDED_FILE_MAX_SIZE:"",EXCEEDED_MAX_FILES:""}));e.exports=a}),null);
__d("XMNLiveChatPluginFileUploadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/plugins/live_chat/upload/",{})}),null);
__d("LiveChatPluginAttachmentUploadClient",["FileForm","LiveChatPluginAttachmentUploadError","LiveChatPluginLoggerUtil","MercuryConstants","MessengerLiveChatPluginEvent","PhotosUploadID","SubscriptionsHandler","XMNLiveChatPluginFileUploadController","cssURL"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=5;function a(a,c,d,e){this.$17=function(event,a){var b;((b=a)!=null?(b=b.response)!=null?(b=b.payload)!=null?b.result:b:b:b)==="success"?this.$25(a):this.$26(a)}.bind(this),this.$1=new Map(),this.$2=new Map(),this.$4=new Map(),this.$5=new Map(),this.$7=d,this.$8=c,this.$9=new(b("SubscriptionsHandler"))(),this.$10=a,this.$11=new Set(),this.$13=new Map(),this.$14=e}a.prototype.onSubmitFileList=function(a){__p&&__p();this.$8(b("LiveChatPluginAttachmentUploadError").NO_ERROR);var c=this.$15();c=this.$16(c);this.$9.addSubscriptions(c.subscribe("success",this.$17));if(a){if(a.length+this.$2.size>g){this.$8(b("LiveChatPluginAttachmentUploadError").EXCEEDED_MAX_FILES);b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").ATTACHMENT_UPLOAD_FAILED,this.$14,this.$7,JSON.stringify({error:"exceeded_max_files"}));return}var d={};for(var e=0;e<a.length;e++){var f=a[e];if(f.size>b("MercuryConstants").AttachmentMaxSize){this.$8(b("LiveChatPluginAttachmentUploadError").EXCEEDED_FILE_MAX_SIZE);b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").ATTACHMENT_UPLOAD_FAILED,this.$14,this.$7,JSON.stringify({error:"exceeded_max_file_size"}));return}var h=this.$18();d[h]=f;this.$11.add(h);this.$2.set(h,{name:f.name,thumbnail_url:b("cssURL")(window.URL.createObjectURL(f)),type:f.type});b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").ATTACHMENT_UPLOAD_SUBMITTED,this.$14,this.$7,JSON.stringify({uploadID:h}))}c.setFiles(d);c.forceSendViaXHR()}this.$10(this.$19(),this.$20())};a.prototype.removeAttachment=function(a){this.$11["delete"](a),this.$1["delete"](a),this.$2["delete"](a),this.$5["delete"](a),this.$4["delete"](a),this.$13["delete"](a),this.$10(this.$19(),this.$20(),this.$21(),this.$22(),this.$23(),this.$24()),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").ATTACHMENT_UPLOAD_REMOVED,this.$14,this.$7,JSON.stringify({uploadID:a}))};a.prototype.removeAllAttachments=function(){this.$1=new Map(),this.$2=new Map(),this.$4=new Map(),this.$5=new Map(),this.$11=new Set(),this.$13=new Map(),this.$10(this.$19(),this.$20(),this.$21(),this.$22(),this.$23(),this.$24())};a.prototype.$25=function(a){var c=a.response.payload;a=a.upload.getName();c=c.metadata[0];this.$11.has(a)&&(this.$11["delete"](a),c.image_id?this.$5.set(a,c.image_id):c.gif_id?this.$1.set(a,c.gif_id):c.video_id?this.$13.set(a,c.video_id):this.$4.set(a,c.file_id),this.$10(this.$19(),this.$20()),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").ATTACHMENT_UPLOAD_COMPLETED,this.$14,this.$7,JSON.stringify({uploadID:a})));this.$27()||this.$10(this.$19(),this.$20(),this.$21(),this.$22(),this.$23(),this.$24())};a.prototype.$26=function(a){this.removeAttachment(a.upload.getName()),this.$8(b("LiveChatPluginAttachmentUploadError").UPLOAD_FAILED),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").ATTACHMENT_UPLOAD_FAILED,this.$14,this.$7,JSON.stringify({error:"upload_failed"}))};a.prototype.$23=function(){return this.$5.size===0?[]:Array.from(this.$5.values())};a.prototype.$21=function(){return this.$1.size===0?[]:Array.from(this.$1.values())};a.prototype.$24=function(){return this.$13.size===0?[]:Array.from(this.$13.values())};a.prototype.$22=function(){return this.$4.size===0?[]:Array.from(this.$4.values())};a.prototype.$27=function(){return this.$11.size!==0};a.prototype.$19=function(){return this.$2};a.prototype.$20=function(){return this.$11};a.prototype.$15=function(){var a=document.createElement("form");a.action=b("XMNLiveChatPluginFileUploadController").getURIBuilder().getURI().toString();a.method="post";return a};a.prototype.$16=function(a){a=new(b("FileForm"))(a);a.setAllowCrossOrigin(!0);a.setUploadInParallel(!0);return a};a.prototype.$18=function(){return"upload_"+b("PhotosUploadID").getNewID()};a.prototype.destroy=function(){this.$9.release(),delete this.$9};e.exports=a}),null);
__d("LiveChatPluginAttachmentInput.react",["cx","InlineBlock.react","LiveChatPluginAttachmentUploadClient","LiveChatPluginLoggerUtil","MessengerLiveChatPluginEvent","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$2=function(){b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").ATTACHMENT_BUTTON_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),c}a.prototype.componentDidMount=function(){this.$1=new(b("LiveChatPluginAttachmentUploadClient"))(this.props.updateComposerAttachmentsAndIDs,this.props.setComposerAttachmentError,this.props.pageID,this.props.viewerID)};a.prototype.componentWillUnmount=function(){this.$1.destroy()};a.prototype.render=function(){return b("React").createElement(b("InlineBlock.react"),{className:"_64mk _2ez5",onClick:this.$2},b("React").createElement("input",{accept:"application/msword, application/pdf, text/csv, text/plain, image/*, video/*",className:"_2ez6",multiple:!0,name:"attachment[]",onChange:function(event){this.$3(event)}.bind(this),ref:"fileInput",title:"Add Files",type:"file"}))};a.prototype.$3=function(event){this.$1.onSubmitFileList(event.target.files),event.target.value=""};a.prototype.removeAttachment=function(a){this.$1.removeAttachment(a)};a.prototype.removeAllAttachments=function(){this.$1.removeAllAttachments()};e.exports=a}),null);
__d("LiveChatPluginBotMenuButtonSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24"},b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},b("React").createElement("g",{fill:this.props.threadColor},b("React").createElement("rect",{x:"2",y:"3",width:"20",height:"1"}),b("React").createElement("rect",{x:"2",y:"11",width:"20",height:"1"}),b("React").createElement("rect",{x:"2",y:"19",width:"20",height:"1"}))))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginArrowButtonSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){var a=this.props.direction==="left"?b("React").createElement("g",{fill:this.props.threadColor},b("React").createElement("polygon",{points:"5.5 12 16 1.5 18 3.5 9.5 12 18 20.5 16 22.5"})):b("React").createElement("g",{fill:this.props.threadColor},b("React").createElement("polygon",{points:"8 7 9.5 5.5 16 12 9.5 18.5 8 17 13 12"}));return b("React").createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24"},b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MNPageMessagingReferralSource",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ADS:"ADS",SHORTLINK:"SHORTLINK",MESSENGER_CODE:"MESSENGER_CODE",DISCOVER_TAB:"DISCOVER_TAB",CUSTOMER_CHAT_PLUGIN:"CUSTOMER_CHAT_PLUGIN",BRANDED_CAMERA:"BRANDED_CAMERA",DISCOVERY_TAB:"DISCOVERY_TAB",LIVECHAT_PLUGIN:"LIVECHAT_PLUGIN"})}),null);
__d("XMNCommercePostbackCTAController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messages/commerce/postback/",{cta_id:{type:"String",required:!0},message_id:{type:"String"},ref:{type:"String"},ref_source:{type:"Enum",enumType:1},ref_type:{type:"Enum",enumType:1}})}),null);
__d("LiveChatPluginBotMenuDialog.react",["cx","fbt","AsyncRequest","Link.react","LiveChatPluginArrowButtonSVG.react","LiveChatPluginLoggerUtil","MercuryIDs","MercuryMessageActions","MercuryMessageObject","MercurySourceType","MessengerLiveChatPluginEvent","MNCommerceCallToActionType","MNPageMessagingReferralSource","React","ShimButton.react","Tooltip.react","XMNCommercePostbackCTAController"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(a){i.constructor.call(this,a),this.state={navigationPath:[]},this.$11=function(){this.props.closeDialogFn(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").BOT_MENU_URL_REDIRECT_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$1=b("MercuryMessageActions").getForFBID(this.props.viewerID),this.$2=new(b("MercuryMessageObject"))(this.props.viewerID),this.$3=b("LiveChatPluginLoggerUtil").getAttributionTags(),this.$4=b("MercuryIDs").getThreadIDFromUserID(this.props.pageID)}a.prototype.render=function(){var a=null,c=[],d=this.props.menuItems;for(var e=0;e<this.state.navigationPath.length;e++){var f=this.state.navigationPath[e];d!=null&&(a=d[f].title,d=d[f].nested_ctas)}c=d&&d.map(function(b,a){return this.$5(b,a)}.bind(this));return b("React").createElement("div",{className:"_6d42"},this.$6(a||h._("Menu")),c)};a.prototype.$6=function(a){var c=this.state.navigationPath.length!==0?b("React").createElement(b("Link.react"),{className:"_4bqf _6d43",onClick:function(a){this.setState(function(a){return{navigationPath:a.navigationPath.slice(0,-1)}})}.bind(this)},b("React").createElement(b("LiveChatPluginArrowButtonSVG.react"),{direction:"left",threadColor:this.props.threadColor})):null;return b("React").createElement("div",{className:"_6d44 _6d45"},c,a)};a.prototype.$5=function(a,c){__p&&__p();var d;switch(a.action_type){case b("MNCommerceCallToActionType").POSTBACK:d=this.$7(a);break;case b("MNCommerceCallToActionType").OPEN_URL:d=this.$8(a);break;case b("MNCommerceCallToActionType").NAVIGATION:d=this.$9(a,c);break;default:d=this.$10(a);break}return b("React").createElement("div",{className:"_6d46",key:a.id},b("React").createElement("div",{className:"_6d45 _4bqf"},d))};a.prototype.$10=function(a){return b("React").createElement(b("Tooltip.react"),{className:"_6d47",tooltip:h._("To use this feature, use the Messenger app.")},a.title)};a.prototype.$8=function(a){return b("React").createElement(b("Link.react"),{className:"_6d48",href:a.action_link,onClick:this.$11,style:{color:this.props.threadColor},target:"_blank"},a.title)};a.prototype.$9=function(a,c){var d=function(a){this.setState(function(a){return{navigationPath:a.navigationPath.concat(c)}})}.bind(this);return b("React").createElement(b("ShimButton.react"),{className:"_6d49",onClick:d},b("React").createElement(b("Link.react"),{style:{color:this.props.threadColor}},a.title),b("React").createElement("div",{className:"_6d4a"},b("React").createElement(b("LiveChatPluginArrowButtonSVG.react"),{direction:"right",threadColor:this.props.threadColor})))};a.prototype.$7=function(a){var c=function(c){this.props.closeDialogFn();this.$1.send(this.$2.constructCTAConfirmationMessageObject(a.title,b("MercurySourceType").CUSTOMER_CHAT_PLUGIN,this.$4,null,this.$3));c=b("XMNCommercePostbackCTAController").getURIBuilder().setString("cta_id",a.id).setEnum("ref_source",b("MNPageMessagingReferralSource").CUSTOMER_CHAT_PLUGIN).getURI();new(b("AsyncRequest"))().setURI(c).setAllowCrossPageTransition(!0).setMethod("POST").send();b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").BOT_MENU_POSTBACK_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this);return b("React").createElement(b("Link.react"),{className:"_6d48",onClick:c,style:{color:this.props.threadColor}},a.title)};e.exports=a}),null);
__d("XMessengerBotsMenuController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messenger/commerce/bots/menu/",{page_id:{type:"String",required:!0}})}),null);
__d("LiveChatPluginBotMenuButton.react",["csx","cx","AsyncRequest","LiveChatPluginBotMenuButtonSVG.react","LiveChatPluginBotMenuDialog.react","LiveChatPluginLoggerUtil","MessengerContextualDialog.react","MessengerLiveChatPluginEvent","Parent","React","ReactDOM","ShimButton.react","Style","XMessengerBotsMenuController"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={flyoutOpen:!1,menuItems:null},this.$4=function(){this.setState(function(a){return{flyoutOpen:!a.flyoutOpen}},this.$8)}.bind(this),this.$7=function(){this.setState({flyoutOpen:!1})}.bind(this),this.$6=function(){this.state.flyoutOpen&&this.$3()}.bind(this),this.$8=function(){b("LiveChatPluginLoggerUtil").logAction(this.state.flyoutOpen?b("MessengerLiveChatPluginEvent").BOT_MENU_OPENED:b("MessengerLiveChatPluginEvent").BOT_MENU_CLOSED,this.props.viewerID,this.props.pageID)}.bind(this),c}a.prototype.UNSAFE_componentWillMount=function(){this.$2()};a.prototype.componentWillUnmount=function(){this.$1&&(this.$1.abort(),this.$1=null),this.state.flyoutOpen&&this.$3()};a.prototype.render=function(){return b("React").createElement(b("ShimButton.react"),{className:"_661n",onClick:this.$4,ref:"botMenuContainer"},b("React").createElement(b("LiveChatPluginBotMenuButtonSVG.react"),{threadColor:this.props.threadColor}),this.$5())};a.prototype.$5=function(){return!this.state.flyoutOpen||!this.state.menuItems?null:b("React").createElement(b("MessengerContextualDialog.react"),{alignment:"right",contextRef:function(){return this.refs.botMenuContainer}.bind(this),hideOnBlur:!0,onBeforeHide:this.$6,position:"above",ref:function(a){if(this.props.isMobile&&a){a=b("Parent").bySelector(b("ReactDOM").findDOMNode(a),"._1r_9");var c=window.innerWidth<310?window.innerWidth-10:300;b("Style").set(a,"max-width",c+"px");b("Style").set(a,"-webkit-tap-highlight-color","transparent")}}.bind(this),shown:this.state.flyoutOpen,width:window.innerWidth<310?window.innerWidth-10:300},b("React").createElement(b("LiveChatPluginBotMenuDialog.react"),{closeDialogFn:this.$7,menuItems:this.state.menuItems,pageID:this.props.pageID,threadColor:this.props.threadColor,viewerID:this.props.viewerID}))};a.prototype.$2=function(){var a=b("XMessengerBotsMenuController").getURIBuilder().setString("page_id",this.props.pageID).getURI();this.$1=new(b("AsyncRequest"))().setURI(a).setHandler(function(a){this.setState({menuItems:a.payload.menu})}.bind(this)).setErrorHandler(function(a){this.setState({menuItems:[]})}.bind(this));this.$1.send()};a.prototype.$3=function(){this.setState({flyoutOpen:!1},this.$8)};e.exports=a}),null);
__d("LiveChatPluginLikeButtonSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("svg",{height:"24px",preserveAspectRatio:"xMinYMax meet",viewBox:"0 0 40.16 42.24",width:"22px"},b("React").createElement("path",{d:"M935.36,1582.44a0,0,0,0,0,0,.06,3.59,3.59,0,0,1-.72,6.53,0,0,0,0,0,0,0,3.56,3.56,0,0,1,.71,2.13,3.6,3.6,0,0,1-3,3.54, 0,0,0,0,0,0,.05,3.56,3.56,0,0,1,.38,1.61,3.61,3.61,0,0,1-3.42,3.6H910v-19.6l5.27-7.9a4,4,0,0,0,.66-2.31l-0.1-4c-0.22-2.4-.09-2.06, 1.13-2.37,2-.51,7.16,1.59,5.13,12.17h11.06A3.59,3.59,0,0,1,935.36,1582.44ZM899,1581h7v22h-7v-22Z",transform:"translate(-898.5 -1563.26)",fill:"none",fillRule:"evenodd",stroke:this.props.threadColor,strokeLinecap:"round",strokeWidth:"2"}))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginMessageComposerAttachmentItem.react",["cx","ix","Image.react","React","ShimButton.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){var a=this.props.attachment;if(a.type.startsWith("image/"))return[b("React").createElement("div",{className:"_3l_i",key:this.props.uploadID+"item",style:{backgroundImage:a.thumbnail_url}}),b("React").createElement(b("ShimButton.react"),{className:"_3l_j _3l_k",key:this.props.uploadID+"removeButton",onClick:this.props.removeAttachment})];var c=b("React").createElement("div",{className:"_3l_l",style:{backgroundColor:this.props.threadColor}},b("React").createElement(b("Image.react"),{src:a.type.startsWith("video/")?h("359148"):h("359146")}));a=a.name;var d=a.split(".").pop().toUpperCase();return b("React").createElement("div",{className:"_3l_m"},c,b("React").createElement("div",{className:"_3l_n"},b("React").createElement("div",{className:"_3l_o"},d),b("React").createElement("div",{className:"_3l_p"},a)),b("React").createElement(b("ShimButton.react"),{className:"_3l_j _3l_q",onClick:this.props.removeAttachment}))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginMessageComposerAttachmentShelf.react",["cx","fbt","LiveChatPluginAttachmentUploadError","LiveChatPluginMessageComposerAttachmentItem.react","React","XUISpinner.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){i.constructor.call(this,a),this.$1=new Map()}a.prototype.render=function(){__p&&__p();if(this.props.attachments.size===0&&this.props.error===b("LiveChatPluginAttachmentUploadError").NO_ERROR)return null;this.props.attachments.forEach(function(a,b){this.$1.has(b)||this.$1.set(b,a)}.bind(this));this.$1.forEach(function(a,b){this.props.attachments.has(b)||this.$1["delete"](b)}.bind(this));var a=Array.from(this.$1).map(function(a){var c=a[0];a=a[1];return b("React").createElement("div",{className:"_1i5v",key:c},b("React").createElement(b("LiveChatPluginMessageComposerAttachmentItem.react"),{attachment:a,removeAttachment:function(){this.props.removeAttachment(c)}.bind(this),threadColor:this.props.threadColor,uploadID:c}),this.props.uploadingAttachments.has(c)?b("React").createElement(b("XUISpinner.react"),{className:"_1i63",background:"dark",size:"large"}):null)}.bind(this));return b("React").createElement("div",{className:"_1i69"},this.$2(),b("React").createElement("div",{className:"_2l9u"},a))};a.prototype.$2=function(){__p&&__p();var a;switch(this.props.error){case b("LiveChatPluginAttachmentUploadError").EXCEEDED_MAX_FILES:a=h._("Upload no more than 5 files at once. Please try again.");break;case b("LiveChatPluginAttachmentUploadError").EXCEEDED_FILE_MAX_SIZE:a=h._("This file exceeds the size limit of 25MB.");break;case b("LiveChatPluginAttachmentUploadError").UPLOAD_FAILED:a=h._("This file couldn't be uploaded. Please try again.");break;case b("LiveChatPluginAttachmentUploadError").NO_ERROR:default:return null}return b("React").createElement("div",{className:"_2l9v"},a)};e.exports=a}),null);
__d("LiveChatPluginSendButtonSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("svg",{width:"22px",height:"22px",viewBox:"0 0 22 22"},b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},b("React").createElement("g",{transform:"translate(-5.000000, -5.000000)",fill:this.props.threadColor},b("React").createElement("g",null,b("React").createElement("g",{transform:"translate(5.000000, 5.000000)"},b("React").createElement("path",{d:"M2.0300068,0.145970044 L20.9662955,9.37015518 C22.3445682,10.0420071 22.3445682,11.9582654 20.9662955,12.6296618 L2.0300068,21.853847 C1.09728834,22.3084288 0,21.6475087 0,20.6317597 L0.806953417,13.8945654 C0.882225434,13.2659853 1.39089595,12.7699536 2.03608467,12.6957083 L12.0229514,11.6795038 C12.8612292,11.5943266 12.8612292,10.4054904 12.0229514,10.3203132 L2.03608467,9.30410872 C1.39089595,9.23031889 0.882225434,8.7342872 0.806953417,8.10525162 L0,1.36805729 C0,0.352308292 1.09728834,-0.3081563 2.0300068,0.145970044"}))))))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginMessageComposer.react",["cx","fbt","AbstractTextInput.react","Keys","LiveChatPluginAttachmentInput.react","LiveChatPluginAttachmentUploadError","LiveChatPluginBotMenuButton.react","LiveChatPluginLikeButtonSVG.react","LiveChatPluginLoggerUtil","LiveChatPluginMessageComposerAttachmentShelf.react","LiveChatPluginSendButtonSVG.react","MercuryIDs","MercuryMessageActions","MercuryMessageObject","MercurySourceType","MessengerLiveChatPluginEvent","React","ShimButton.react","StickerConstants"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){__p&&__p();i.constructor.call(this,a),this.state={attachmentsDataMap:new Map(),error:b("LiveChatPluginAttachmentUploadError").NO_ERROR,inputValue:"",uploadingAttachments:new Set()},this.$20=function(a){this.props.onChange(),this.setState({error:b("LiveChatPluginAttachmentUploadError").NO_ERROR,inputValue:a.target.value})}.bind(this),this.$21=function(a){a.keyCode===b("Keys").RETURN&&(a.preventDefault(),this.$18())}.bind(this),this.$18=function(){__p&&__p();if(this.state.uploadingAttachments.size!==0)return;var a=this.state.inputValue.trim();if(a&&a.length>0||this.state.attachmentsDataMap.size>0){a=this.$7.constructUserGeneratedMessageObject(a,b("MercurySourceType").CUSTOMER_CHAT_PLUGIN,this.$8,null,null,this.$9);this.$4.length>0&&(a.has_attachment=!0,a.image_ids=this.$4);this.$1.length>0&&(a.has_attachment=!0,a.gif_ids=this.$1);this.$10.length>0&&(a.has_attachment=!0,a.video_ids=this.$10);this.$3.length>0&&(a.has_attachment=!0,a.file_ids=this.$3);this.$6.send(a);this.setState({inputValue:""});this.$22();b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").MESSAGE_SENT,this.props.viewerID,this.props.pageID,this.state.attachmentsDataMap.size>0?JSON.stringify({attachments:Array.from(this.state.attachmentsDataMap.keys())}):null)}}.bind(this),this.$19=function(){this.$6.send(this.$7.constructStickerMessageObject(b("StickerConstants").HOT_LIKE_SMALL_STICKER_ID,b("MercurySourceType").CUSTOMER_CHAT_PLUGIN,this.$8,this.$9)),this.setState({error:b("LiveChatPluginAttachmentUploadError").NO_ERROR,inputValue:""}),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").LIKE_BUTTON_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$11=function(a){this.$2&&this.$2.removeAttachment(a)}.bind(this),this.$16=function(a){this.setState({error:a})}.bind(this),this.$17=function(a,c,d,e,f,g){d&&(this.$1=d),e&&(this.$3=e),f&&(this.$4=f),g&&(this.$10=g),this.setState({attachmentsDataMap:new Map(a),error:b("LiveChatPluginAttachmentUploadError").NO_ERROR,uploadingAttachments:new Set(c)}),this.focus()}.bind(this),this.$6=b("MercuryMessageActions").getForFBID(this.props.viewerID),this.$7=b("MercuryMessageObject").getForFBID(this.props.viewerID),this.$8=b("MercuryIDs").getThreadIDFromUserID(this.props.pageID),this.$9=b("LiveChatPluginLoggerUtil").getAttributionTags(),this.$1=[],this.$3=[],this.$4=[],this.$10=[]}a.prototype.render=function(){return b("React").createElement("div",{className:"_336a"+(this.props.disableInput?" _664i":"")},b("React").createElement(b("LiveChatPluginMessageComposerAttachmentShelf.react"),{attachments:this.state.attachmentsDataMap,error:this.state.error,removeAttachment:this.$11,threadColor:this.props.threadColor,uploadingAttachments:this.state.uploadingAttachments}),b("React").createElement("div",{className:"_4zbw"},this.$12(),this.$13(),b("React").createElement("div",{className:"_kmd"},this.$14(),this.$15())))};a.prototype.$14=function(){return this.props.isMobile||this.props.disableInput?null:b("React").createElement(b("LiveChatPluginAttachmentInput.react"),{pageID:this.props.pageID,ref:function(a){this.$2=a}.bind(this),setComposerAttachmentError:this.$16,updateComposerAttachmentsAndIDs:this.$17,viewerID:this.props.viewerID})};a.prototype.$15=function(){if(this.props.disableInput)return null;if(this.state.inputValue.length>0||this.state.attachmentsDataMap.size>0)return b("React").createElement(b("ShimButton.react"),{className:"_4bqf _64mk _64ml",onClick:this.$18},b("React").createElement(b("LiveChatPluginSendButtonSVG.react"),{threadColor:this.props.threadColor}));else return b("React").createElement(b("ShimButton.react"),{className:"_4bqf _64mk _68t0",onClick:this.$19},b("React").createElement(b("LiveChatPluginLikeButtonSVG.react"),{threadColor:this.props.threadColor}))};a.prototype.$13=function(){return this.props.disableInput?b("React").createElement("div",{className:"_664k"},h._("Composer is disabled for this thread.")):b("React").createElement("div",{className:"_4fwe"},b("React").createElement(b("AbstractTextInput.react"),{onBlur:this.props.onBlur,onChange:this.$20,onClick:this.props.onClick,onFocus:this.props.onFocus,onKeyDown:this.$21,ref:function(a){this.$5=a}.bind(this),placeholder:h._("Type a message...").toString(),value:this.state.inputValue}))};a.prototype.$12=function(){return this.props.hasMenu?b("React").createElement(b("LiveChatPluginBotMenuButton.react"),{isMobile:this.props.isMobile,threadColor:this.props.threadColor,pageID:this.props.pageID,viewerID:this.props.viewerID}):null};a.prototype.$22=function(){this.$2&&this.$2.removeAllAttachments()};a.prototype.focus=function(){this.$5&&this.$5.focusInput()};e.exports=a}),null);
__d("LiveChatPluginMobilePrompt.react",["ix","cx","Image.react","LiveChatPluginFbts","LiveChatPluginLoggerUtil","MessengerLiveChatPluginEvent","React","ShimButton.react","asset"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=24,k=24;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$3=function(){this.props.onCloseButtonClick&&(this.props.onCloseButtonClick(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").MOBILE_PROMPT_CLOSE_CLICKED,this.props.viewerID,this.props.pageID))}.bind(this),c}a.prototype.componentDidMount=function(){setTimeout(function(){this.$2()}.bind(this),750)};a.prototype.componentDidUpdate=function(a){(this.props.isLoggedIn&&a.loggedInGreeting!==this.props.loggedInGreeting||!this.props.isLoggedIn&&a.loggedOutGreeting!==this.props.loggedOutGreeting)&&this.$2()};a.prototype.render=function(){return b("React").createElement("div",{className:"_6i-7"},b("React").createElement(b("ShimButton.react"),{className:"_6lg-",onClick:this.$3},b("React").createElement(b("Image.react"),{src:g("491580")})),b("React").createElement(b("ShimButton.react"),{onClick:this.props.onClick},this.$4()))};a.prototype.$2=function(){if(this.$1){var a=this.$1.offsetHeight+j+k;this.props.anchorIframeResizeFn(a,a)}};a.prototype.$4=function(){var a;this.props.isLoggedIn?this.props.loggedInGreeting!=null?a=this.props.loggedInGreeting:a=b("LiveChatPluginFbts").DEFAULT_LOGGED_IN_GREETING_TEXT:this.props.loggedOutGreeting!=null?a=this.props.loggedOutGreeting:a=b("LiveChatPluginFbts").DEFAULT_LOGGED_OUT_GREETING_TEXT;return b("React").createElement("div",{className:"_6i-8",ref:function(a){return this.$1=a}.bind(this)},b("React").createElement("div",{className:"_6i-9"},this.props.pageName),b("React").createElement("div",null,a))};e.exports=a}),null);
__d("XMNLiveChatBlockMessageController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/plugins/live_chat/block/",{page_id:{type:"String",required:!0}})}),null);
__d("XMNLiveChatUnblockMessageController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/plugins/live_chat/unblock/",{page_id:{type:"String",required:!0}})}),null);
__d("LiveChatPluginDialogContainer.react",["cx","AsyncRequest","JSResource","LazyComponent.react","LiveChatPluginAnonymousUserPrompt.react","LiveChatPluginDialogHeader.react","LiveChatPluginLoggedInMobileInterstitial.react","LiveChatPluginLoggedInUserPrompt.react","LiveChatPluginLoggerUtil","LiveChatPluginMessageComposer.react","LiveChatPluginMobilePrompt.react","LoadOnRender.react","MercuryIDs","MercuryThreadActions","MessengerLiveChatPluginEvent","MessengerLiveChatSettings","MessengerSpinner.react","MessengerState.bs","QE2Logger","React","ReactCSSTransitionGroup","ReactDOM","UnverifiedXD","UserAgent","XMNLiveChatBlockMessageController","XMNLiveChatUnblockMessageController","emptyFunction","gkx","performanceAbsoluteNow"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("MercuryThreadActions").get();c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(a){__p&&__p();h.constructor.call(this,a),this.state={chatPromptHeight:-1,dialogBodyHeight:-1,informationViewOpen:!1,isPageBlocked:!1},this.$13=function(a){b("JSResource").loadAll([b("JSResource")("LiveChatPluginDialogBody.react").__setRef("LiveChatPluginDialogContainer.react")],function(c){a(c),b("LiveChatPluginLoggerUtil").logChatDisplayDone(this.props.viewerID,this.props.pageID,this.$2)}.bind(this))}.bind(this),this.$8=function(a,b){this.setState({chatPromptHeight:b}),this.props.anchorIframeResizeFn(a)}.bind(this),this.$4=function(){var a=b("ReactDOM").findDOMNode(this),c=b("ReactDOM").findDOMNode(this.$3),d=b("ReactDOM").findDOMNode(this.$1);if(a&&a instanceof HTMLElement&&c&&c instanceof HTMLElement&&d&&d instanceof HTMLElement){a=a.getBoundingClientRect().height-c.getBoundingClientRect().height-d.getBoundingClientRect().height;a!==this.state.dialogBodyHeight&&this.setState({dialogBodyHeight:a})}}.bind(this),this.$17=function(){this.props.onMobilePromptClick&&this.props.onMobilePromptClick(this.props.isLoggedIn,this.props.canSkipContinuousAs,this.props.pageID,this.props.refererUri,this.props.viewerID)}.bind(this),this.$10=function(){var a=b("XMNLiveChatBlockMessageController").getURIBuilder().setString("page_id",this.props.pageID).getURI();this.setState({isPageBlocked:!0});new(b("AsyncRequest"))().setURI(a).setAllowCrossPageTransition(!0).send();b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").BLOCK_MESSAGE_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$12=function(){var a=b("XMNLiveChatUnblockMessageController").getURIBuilder().setString("page_id",this.props.pageID).getURI();this.setState({isPageBlocked:!1});new(b("AsyncRequest"))().setURI(a).setAllowCrossPageTransition(!0).send();b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").UNBLOCK_MESSAGE_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$11=function(){this.setState(function(){return{informationViewOpen:!1}})}.bind(this),this.$9=function(){this.setState(function(a){return{informationViewOpen:!a.informationViewOpen}},this.$18)}.bind(this),this.$18=function(){b("LiveChatPluginLoggerUtil").logAction(this.state.informationViewOpen?b("MessengerLiveChatPluginEvent").INFORMATION_BUTTON_OPENED:b("MessengerLiveChatPluginEvent").INFORMATION_BUTTON_CLOSED,this.props.viewerID,this.props.pageID)}.bind(this),this.$2=b("performanceAbsoluteNow")()}a.prototype.componentDidMount=function(){this.props.isMobile&&this.props.chatStarted&&this.props.hasMessagingPermission&&window.addEventListener("resize",this.$4);if(this.props.chatStarted&&this.props.hasMessagingPermission&&this.props.isLoggedIn){var a=b("ReactDOM").findDOMNode(this);a&&a instanceof HTMLElement&&(a.addEventListener("click",function(){this.$5()}.bind(this)),this.props.isMobile||a.addEventListener("click",function(){this.$6()}.bind(this)))}this.props.isMobile&&b("gkx")("678740")&&!this.props.chatStarted&&b("QE2Logger").logExposureForUser("customer_chat_mobile_redesign")};a.prototype.render=function(){__p&&__p();var a;a=(a=b("MessengerLiveChatSettings").qeSettings)!=null?a.showNewDesign:a;if(this.props.isMobile&&a&&!this.props.chatStarted)return this.$7();var c;!this.props.chatStarted||!this.props.hasMessagingPermission?(a=!0,c=this.props.isLoggedIn?b("React").createElement(b("LiveChatPluginLoggedInUserPrompt.react"),{anchorIframeResizeFn:this.$8,canSkipContinuousAs:this.props.canSkipContinuousAs,hasMessagingPermission:this.props.hasMessagingPermission,isFacebookApp:this.props.isFacebookApp,key:"logged_in_prompt",loggedInGreeting:this.props.loggedInGreeting,onChatNowClick:this.props.onChatNowClick,onCloseButtonClick:this.props.onCloseButtonClick,pageID:this.props.pageID,pageProfilePictureUri:this.props.pageProfilePictureUri,refererUri:this.props.refererUri,threadColor:this.props.threadColor,viewerID:this.props.viewerID,viewerProfilePictureUri:this.props.viewerProfilePictureUri}):b("React").createElement(b("LiveChatPluginAnonymousUserPrompt.react"),{anchorIframeResizeFn:this.$8,key:"anonymous_prompt",loggedOutGreeting:this.props.loggedOutGreeting,onCloseButtonClick:this.props.onCloseButtonClick,pageID:this.props.pageID,pageProfilePictureUri:this.props.pageProfilePictureUri,refererUri:this.props.refererUri,threadColor:this.props.threadColor,viewerID:this.props.viewerID})):this.props.isLoggedIn?(a=!1,c=b("React").createElement("div",{className:"_3gog"+(this.props.isMobile?"":" _6ati")+(this.props.isMobile?" _6atj":""),key:"dialog_container",style:this.props.isMobile?null:{borderRadius:"9pt"}},b("React").createElement(b("LiveChatPluginDialogHeader.react"),{informationViewOpen:this.state.informationViewOpen,onCloseButtonClick:this.props.onCloseButtonClick,onInformationButtonClick:this.$9,pageID:this.props.pageID,pageName:this.props.pageName,pageResponsivenessText:this.props.pageResponsivenessText,ref:function(a){return this.$3=a}.bind(this),threadColor:this.props.threadColor,viewerID:this.props.viewerID}),b("React").createElement("div",{className:"_424s"},b("React").createElement(b("LoadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{blockMessage:this.$10,deliveryReceipt:b("MessengerState.bs").deliveryReceipts(this.props.messengerState),dialogBodyHeight:this.state.dialogBodyHeight,isMobile:this.props.isMobile,isMuted:this.props.isMuted,isPageBlocked:this.state.isPageBlocked,informationViewOpen:this.state.informationViewOpen,messengerState:this.props.messengerState,onClick:this.$11,pageID:this.props.pageID,pageName:this.props.pageName,pageProfilePictureUri:this.props.pageProfilePictureUri,readReceipt:this.props.readReceipt,threadColor:this.props.threadColor,unblockMessage:this.$12,viewerID:this.props.viewerID}),loader:this.$13,placeholder:b("React").createElement("div",{className:"spinner"},b("React").createElement(b("MessengerSpinner.react"),{color:"blue",size:b("MessengerSpinner.react").large_size}))})),b("React").createElement(b("LiveChatPluginMessageComposer.react"),{disableInput:this.props.disableInput,hasMenu:this.props.hasMenu,isMobile:this.props.isMobile,onBlur:this.$14()?this.$15:b("emptyFunction"),onChange:this.$11,onClick:this.$11,onFocus:this.$14()?this.$16:b("emptyFunction"),pageID:this.props.pageID,ref:function(a){return this.$1=a}.bind(this),threadColor:this.props.threadColor,viewerID:this.props.viewerID}))):(c=null,a=!1);var d=this.state.chatPromptHeight!==-1&&a?{height:this.state.chatPromptHeight}:{};if(!b("UserAgent").isBrowser("IE <= 9")&&!this.props.isMobile)return b("React").createElement("div",{className:(this.state.chatPromptHeight!==-1&&!a?"_6atk":"")+(a?"":" _6atl")+" _6atm",style:d},b("React").createElement(b("ReactCSSTransitionGroup"),{transitionName:{enter:"_6atn",enterActive:"_6ato",leave:"_6atp",leaveActive:"_6atq"},transitionEnterTimeout:200,transitionLeaveTimeout:200},c));else return b("React").createElement("div",{className:(!a&&!this.props.isMobile?"_6atl":"")+(!a&&this.props.isMobile?" _6atr":"")+" _6atm",style:d},c)};a.prototype.$7=function(){return this.props.showInterstitialOnPage&&this.props.isLoggedIn?b("React").createElement(b("LiveChatPluginLoggedInMobileInterstitial.react"),{loggedInGreeting:this.props.loggedInGreeting,onChatNowClick:this.props.onChatNowClick,onCloseButtonClick:this.props.onCloseButtonClickWithoutLog,pageID:this.props.pageID,pageName:this.props.pageName,refererUri:this.props.refererUri,viewerID:this.props.viewerID}):b("React").createElement(b("LiveChatPluginMobilePrompt.react"),{anchorIframeResizeFn:this.$8,isLoggedIn:this.props.isLoggedIn,loggedInGreeting:this.props.loggedInGreeting,loggedOutGreeting:this.props.loggedOutGreeting,onClick:this.$17,onCloseButtonClick:this.props.onCloseButtonClickWithoutLog,pageID:this.props.pageID,pageName:this.props.pageName,viewerID:this.props.viewerID})};a.prototype.$15=function(){b("UnverifiedXD").send({type:"liveChatPluginBlurComposer"})};a.prototype.$16=function(){b("UnverifiedXD").send({type:"liveChatPluginFocusComposer"})};a.prototype.$14=function(){return/iPhone|iPad|iPod/.test(navigator.userAgent)};a.prototype.$5=function(){i.markRead(b("MercuryIDs").getThreadIDFromUserID(this.props.pageID))};a.prototype.$6=function(){this.$1&&this.$1.focus()};e.exports=a}),null);
__d("XMNPlatformCustomerChatPluginOpenThreadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messages/commerce/customer_chat_plugin/open_thread/",{page_id:{type:"FBID",required:!0},request_id:{type:"String",required:!0},referer_uri:{type:"String",required:!0},ref:{type:"String"}})}),null);
__d("LiveChatPlugin.react",["cx","Arbiter","AsyncRequest","CurrentUser","LiveChatMqttClient","LiveChatPluginConstants","LiveChatPluginDialogContainer.react","LiveChatPluginLocalStorageUtil","LiveChatPluginLoggerUtil","MessengerLiveChatPluginEvent","MessengerState.bs","React","XMNPlatformCustomerChatPluginOpenThreadController"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("MessengerState.bs").jsComponent;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=!1,this.state={chatStarted:b("LiveChatPluginLocalStorageUtil").getChatStarted(),hasMessagingPermission:this.props.hasMessagingPermission,loggedInGreeting:this.props.loggedInGreeting,loggedOutGreeting:this.props.loggedOutGreeting,refParam:this.props.refParam,showInterstitialOnPage:this.props.showInterstitialOnPage},this.$5=function(){this.props.onCloseButtonClick(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").CHAT_DIALOG_CLOSED,this.props.viewerID,this.props.pageID)}.bind(this),this.startChat=function(){this.props.onChatNowClick(),!this.state.hasMessagingPermission?this.$3(!0):this.$6(),setTimeout(function(){this.setState({chatStarted:!0,hasMessagingPermission:!0},function(){b("LiveChatPluginLocalStorageUtil").setChatStarted(!0),b("Arbiter").inform(b("LiveChatPluginConstants").RESET_BADGING)})}.bind(this),30)}.bind(this),this.$6=function(){var a=b("LiveChatPluginLocalStorageUtil").getRefSent();if(!a){a=b("XMNPlatformCustomerChatPluginOpenThreadController").getURIBuilder().setFBID("page_id",this.props.pageID).setString("ref",this.state.refParam).setString("referer_uri",this.props.refererUri).setString("request_id",b("LiveChatPluginLocalStorageUtil").getRequestID()).getRequest(new(b("AsyncRequest"))());a.setAllowCrossPageTransition(!0).setMethod("POST").send();b("LiveChatPluginLocalStorageUtil").setRefSent(!0)}}.bind(this),c}a.prototype.componentDidMount=function(){this.$1=!0,b("CurrentUser").isLoggedIn()||(this.setState({chatStarted:!1}),b("LiveChatPluginLocalStorageUtil").setChatStarted(!1),b("LiveChatPluginLocalStorageUtil").setRefSent(!1)),this.state.chatStarted&&this.state.hasMessagingPermission?(this.$3(!0),b("LiveChatPluginLocalStorageUtil").setChatStarted(!0)):this.props.hasMessagingPermission&&this.$3(!1),this.$2=b("Arbiter").subscribe("Connect.Unsafe.updateCustomerChat",function(a,b){a={};var c=this.$4(b.logged_in_greeting),d=this.$4(b.logged_out_greeting);c!==null&&(a.loggedInGreeting=c);d!==null&&(a.loggedOutGreeting=d);b.ref&&(a.refParam=b.ref);this.setState(a)}.bind(this)),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").PLUGIN_LOADED,this.props.viewerID,this.props.pageID,JSON.stringify({greetingDialogDisplay:this.props.greetingDialogDisplay,greetingDialogDelay:this.props.greetingDialogDelay,isMobile:this.props.isMobile,reloaded:this.props.reloaded,isDialogHidden:b("LiveChatPluginLocalStorageUtil").getIsDialogHidden(),isMuted:this.props.isMuted}),this.props.threadColor,this.state.loggedInGreeting,this.state.loggedOutGreeting)};a.prototype.componentWillUnmount=function(){this.$1=!1,this.$2&&b("Arbiter").unsubscribe(this.$2)};a.prototype.render=function(){return b("React").createElement("div",{className:"_30ss"+(!this.props.isMobile||!this.state.chatStarted?" _3-8j":"")},b("React").createElement(i,{fbid:this.props.viewerID},function(a){return b("React").createElement(b("LiveChatPluginDialogContainer.react"),{anchorIframeResizeFn:this.props.anchorIframeResizeFn,canSkipContinuousAs:this.props.canSkipContinuousAs,chatStarted:this.state.chatStarted,disableInput:this.props.disableInput,hasMenu:this.props.hasMenu,hasMessagingPermission:this.state.hasMessagingPermission,isFacebookApp:this.props.isFacebookApp,isLoggedIn:this.props.isLoggedIn,isMobile:this.props.isMobile,isMuted:this.props.isMuted,loggedInGreeting:this.state.loggedInGreeting,loggedOutGreeting:this.state.loggedOutGreeting,messengerState:a,onChatNowClick:this.startChat,onCloseButtonClick:this.$5,onCloseButtonClickWithoutLog:this.props.onCloseButtonClick,onMobilePromptClick:this.props.onMobilePromptClick,pageID:this.props.pageID,pageName:this.props.pageName,pageProfilePictureUri:this.props.pageProfilePictureUri,pageResponsivenessText:this.props.pageResponsivenessText,readReceipt:this.props.readReceipt,refererUri:this.props.refererUri,showInterstitialOnPage:this.state.showInterstitialOnPage,threadColor:this.props.threadColor?this.props.threadColor:"#0084FF",viewerID:this.props.viewerID,viewerProfilePictureUri:this.props.viewerProfilePictureUri})}.bind(this)))};a.prototype.$3=function(a){b("LiveChatMqttClient").setUp(this.props.pageID,this.props.viewerID,null,a?this.$6:null)};a.prototype.$4=function(a){if(!a)return null;else if(Array.from(a).length>80)return null;else return a};a.prototype.updateShowInterstitialOnPage=function(a){this.$1&&this.setState({showInterstitialOnPage:a})};e.exports=a}),null);
__d("LiveChatPluginBadgeSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){var a={fontSize:"8px",text:this.props.unreadCount,cx:"12",cy:"8",rx:"8",ry:"8"};if(this.props.unreadCount===0)return null;else this.props.unreadCount>20?(a.text="20+",a.cx="11",a.rx="9"):this.props.unreadCount<10&&(a.fontSize="9px");return b("React").createElement("svg",{x:"40",y:"0",width:"20",height:"20"},b("React").createElement("ellipse",{cx:a.cx,cy:a.cy,rx:a.rx,ry:a.ry,fill:"#e8423e"}),b("React").createElement("text",{x:"12",y:"8",textAnchor:"middle",fill:"#ffffff",fontSize:a.fontSize,fontFamily:"Arial",dy:".4em"},a.text))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginMessengerIconSVGWithColor.react",["React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("svg",{x:"0",y:"0",width:"60",height:"60"},b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},b("React").createElement("g",null,b("React").createElement("g",null,b("React").createElement("circle",{fill:this.props.threadColor,cx:"30",cy:"30",r:"30"}),b("React").createElement("g",{transform:"translate(10.000000, 11.000000)",fill:"#FFFFFF"},b("React").createElement("path",{d:"M0,18.7150914 C0,8.37723141 8.956743,0 20,0 C31.043257,0 40,8.37723141 40,18.7150914 C40,29.0529515 31.043257,37.4301829 20,37.4301829 C18,37.4301829 16.0763359,37.1551856 14.2544529,36.6459314 L6.95652174,40 L6.95652174,33.0434783 C2.44929143,29.6044708 0,24.5969773 0,18.7150914 Z M16.9276495,19.6993886 L22.109375,25.0798234 L33.0434783,13.4782609 L23.0672554,18.9962636 L17.890625,13.6158288 L6.95652174,25.2173913 L16.9276495,19.6993886 Z"}))))))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginBadgableMessengerIcon.react",["Arbiter","LiveChatPluginBadgeSVG.react","LiveChatPluginConstants","LiveChatPluginDefaultMessengerIconSVG.react","LiveChatPluginLocalStorageUtil","LiveChatPluginMessengerIconSVGWithColor.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").Component);g=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.state={unreadCount:this.props.unreadCount},this.$1=null,b}a.prototype.componentDidMount=function(){this.$1=b("Arbiter").subscribe(b("LiveChatPluginConstants").UNREAD_COUNT_UPDATE,function(a,b){this.setState({unreadCount:b})}.bind(this))};a.prototype.componentWillUnmount=function(){this.$1&&b("Arbiter").unsubscribe(this.$1)};a.prototype.render=function(){var a=this.props.threadColor!=null?b("React").createElement(b("LiveChatPluginMessengerIconSVGWithColor.react"),{threadColor:this.props.threadColor}):b("React").createElement(b("LiveChatPluginDefaultMessengerIconSVG.react"),null),c=null;(!b("LiveChatPluginLocalStorageUtil").getChatStarted()||b("LiveChatPluginLocalStorageUtil").getIsDialogHidden())&&(c=b("React").createElement(b("LiveChatPluginBadgeSVG.react"),{unreadCount:this.state.unreadCount}));return b("React").createElement("svg",{width:"60px",height:"60px",viewBox:"0 0 60 60"},a,c)};e.exports=a}),null);
__d("LiveChatGreetingDialogDisplayMode",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({UNSET:"unset",SHOW:"show",HIDE:"hide",FADE:"fade"})}),null);
__d("LiveChatPluginMount",["Arbiter","Bootloader","CurrentUser","LiveChatGreetingDialogDisplayMode","LiveChatPlugin.react","LiveChatPluginBadgableMessengerIcon.react","LiveChatPluginConstants","LiveChatPluginFbts","LiveChatPluginLocalStorageUtil","LiveChatPluginLoggerUtil","MessengerLiveChatPluginEvent","MessengerLiveChatSettings","Plugin","PluginOptin","React","ReactDOM","ShimButton.react","Style","UnverifiedXD","performanceAbsoluteNow"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={HIDE:"hide",SHOW:"show",FADE_OUT:"fade_out"};function a(a){__p&&__p();var c,d=a.container,e=a.canSkipContinuousAs,f=a.disableInput,g=a.greetingDialogDisplay,h=a.greetingDialogDelay,i=a.greetingDialogFadeDelay,j=a.hasMenu,k=a.hasMessagingPermission;a.icebreakerQuestions;var l=a.initSeqID,m=a.isFacebookApp,n=a.isThreadDeleted,o=a.isMuted,p=a.loggedInGreeting,q=a.loggedOutGreeting,r=a.originDomain,s=a.pageID,t=a.pageName,u=a.pageProfilePictureUri,v=a.pageResponsivenessText;a.qeParameters;var w=a.readReceipt,x=a.refererUri,y=a.refParam,z=a.reloaded,A=a.requestID,B=a.soundURLs,C=a.threadCSSColor,D=a.unreadCount;a=a.viewerProfilePictureUri;this.$13=function(a,c,d,e,f){this.$22();var g=this.$10?this.$10:b("LiveChatPluginFbts").DEFAULT_LOGGED_IN_GREETING_TEXT.toString(),h=this.$11?this.$11:b("LiveChatPluginFbts").DEFAULT_LOGGED_OUT_GREETING_TEXT.toString();a?c?this.$23():this.$24(d,f,e,g,h):this.$25(d,e,h)}.bind(this);this.$19=function(){this.$22(),this.$20()}.bind(this);this.$18=function(){this.$22(),b("UnverifiedXD").send({type:"liveChatPluginExpandDialogIframe",isMobile:this.$3})}.bind(this);var E=b("performanceAbsoluteNow")();this.$3=/iPhone|iPod|iPad|Android|Mobile/i.test(navigator.userAgent);this.$5=(c=b("MessengerLiveChatSettings").qeSettings)!=null?c.showNewDesign:c;this.$10=p;this.$11=q;l||(l=0);var F=b("CurrentUser").isLoggedIn(),G=b("CurrentUser").getID(),H=b("LiveChatPluginLocalStorageUtil").getLocalState(r,s,G)===null;this.$12(n,k,r,s,z,A,G,g,h);F&&b("Bootloader").loadModules(["LiveChatPluginAlerts","MercurySyncDeltaHandler"],function(a,c){a.init(G,s,t,B,o,D),c.get(),b("Arbiter").inform("MercurySyncDeltaHandler/initSeqID",{fbid:G,seqID:l})},"LiveChatPluginMount");b("UnverifiedXD").send({type:"liveChatPluginPrepareAnchorIframe",chatStarted:b("LiveChatPluginLocalStorageUtil").getChatStarted(),dialogHidden:this.$2,isMobile:this.$3,passesMobileRedesignGK:this.$5,showInterstitialOnPage:this.$9});var I=b("React").createElement(b("ShimButton.react"),{onClick:function(){this.$3&&this.$5&&!b("LiveChatPluginLocalStorageUtil").getChatStarted()?this.$13(F,e,s,x,G):this.$14(G,s)}.bind(this),style:{cursor:"pointer",outline:"none"}},b("React").createElement(b("LiveChatPluginBadgableMessengerIcon.react"),{threadColor:C,unreadCount:D}));b("Arbiter").subscribeOnce("blankIframeAck",function(a,c){this.$1=c,b("ReactDOM").render(I,c.document.body),b("Style").set(c.document.body,"margin","0"),this.$15(D,k),this.$16(h,g,i,H)}.bind(this));b("Arbiter").subscribe("Connect.Unsafe.CustomerChat.isDialogHidden",function(a,c){c.is_dialog_hidden!=null&&(this.$2=c.is_dialog_hidden,b("LiveChatPluginLocalStorageUtil").setIsDialogHidden(this.$2),b("Arbiter").inform(b("LiveChatPluginConstants").RESET_BADGING))}.bind(this));c=null;w&&w.get("watermark")&&w.get("action")&&(c={watermark:Number(w.get("watermark")),action:Number(w.get("action"))});b("ReactDOM").render(b("React").createElement(b("LiveChatPlugin.react"),{anchorIframeResizeFn:this.$17,canSkipContinuousAs:e,disableInput:f,greetingDialogDelay:h,greetingDialogDisplay:g,hasMenu:j,hasMessagingPermission:k,isFacebookApp:m,isLoggedIn:F,isMobile:this.$3,isMuted:o,loggedInGreeting:p,loggedOutGreeting:q,onChatNowClick:this.$18,onCloseButtonClick:this.$19,onMobilePromptClick:this.$13,pageID:s,pageName:t,pageProfilePictureUri:u,pageResponsivenessText:v,readReceipt:c,ref:function(a){return this.$8=a}.bind(this),refererUri:x,refParam:y,reloaded:z,showInterstitialOnPage:this.$9,threadColor:C,viewerID:G,viewerProfilePictureUri:a}),d);this.$15(D,k);b("LiveChatPluginLoggerUtil").logTTI(G,s,E)}a.prototype.$16=function(a,c,d,e){__p&&__p();if(!e)return;e=!1;switch(c){case b("LiveChatGreetingDialogDisplayMode").FADE:e=!this.$3&&a>0;break;case b("LiveChatGreetingDialogDisplayMode").SHOW:e=a>0;break;case b("LiveChatGreetingDialogDisplayMode").UNSET:if(this.$3&&this.$5){c=(c=b("MessengerLiveChatSettings").qeSettings)!=null?c.promptDefaultBehavior:c;if(c===g.FADE_OUT){setTimeout(function(){this.$2||this.$20()}.bind(this),5e3);return}}else e=this.$3?!1:a>0;break;case b("LiveChatGreetingDialogDisplayMode").HIDE:break;default:break}if(!e)return;this.$7=setTimeout(function(){this.$21(d)}.bind(this),a)};a.prototype.$21=function(a){this.$2&&(this.$20(),a&&(this.$6=setTimeout(function(){this.$2||this.$20()}.bind(this),a)))};a.prototype.$17=function(a){b("UnverifiedXD").send({type:"liveChatPluginResizeAnchorIframe",height:a})};a.prototype.$15=function(a,c){if(this.$1){b("UnverifiedXD").send({type:"liveChatPluginShowBubbleIframe",dialogHidden:this.$2,showBadge:a>0&&(b("LiveChatPluginLocalStorageUtil").getChatStarted()?this.$2:c)});return}b("UnverifiedXD").send({type:"liveChatPluginGetBubbleIframe",isHTTPS:window.location.protocol==="https:",fromIframe:window.name})};a.prototype.$14=function(a,c){this.$22();this.$20();var d=b("LiveChatPluginLocalStorageUtil").getChatStarted(),event;d?event=this.$2?b("MessengerLiveChatPluginEvent").CHAT_DIALOG_CLOSED:b("MessengerLiveChatPluginEvent").CHAT_DIALOG_OPENED:event=this.$2?b("MessengerLiveChatPluginEvent").CHAT_NOW_PROMPT_CLOSED:b("MessengerLiveChatPluginEvent").CHAT_NOW_PROMPT_OPENED;b("LiveChatPluginLoggerUtil").logAction(event,a,c)};a.prototype.$23=function(){b("UnverifiedXD").send({type:"liveChatPluginShowInterstitialOnPage",dialogHidden:this.$2}),this.$2=!1,b("LiveChatPluginLocalStorageUtil").setIsDialogHidden(this.$2),b("LiveChatPluginLocalStorageUtil").setShowInterstitialOnPage(!0),setTimeout(function(){this.$8&&this.$8.updateShowInterstitialOnPage(!0)}.bind(this),150)};a.prototype.$24=function(a,c,d,e,f){this.$2||this.$20(),new(b("PluginOptin"))("customer_chat").addLoginParams({logged_in:!0,page_id:a,request_id:b("LiveChatPluginLocalStorageUtil").getRequestID(),switch_user:!1,greeting_text:e}).start(),b("Arbiter").subscribe(b("Plugin").CONNECT,function(){this.$8&&this.$8.startChat(),this.$2&&this.$20()}.bind(this)),b("Arbiter").subscribe(b("LiveChatPluginConstants").SWITCH_ACCOUNT,function(){this.$26(a,c,d,f),this.$2||this.$20()}.bind(this))};a.prototype.$25=function(a,c,d){this.$2||this.$20(),new(b("PluginOptin"))("customer_chat").addLoginParams({logged_in:!1,page_id:a,switch_user:!1,greeting_text:d}).addReturnParams({customer_chat_origin_uri:c,referer_uri:c}).start()};a.prototype.$20=function(){b("UnverifiedXD").send({type:this.$2?"liveChatPluginShowDialogIframe":"liveChatPluginHideDialogIframe",chatStarted:b("LiveChatPluginLocalStorageUtil").getChatStarted(),isMobile:this.$3})};a.prototype.$26=function(a,c,d,e){new(b("PluginOptin"))("customer_chat").addLoginParams({logged_in:!1,page_id:a,switch_user:!0,greeting_text:e}).addReturnParams({referer_uri:d}).start(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").NOT_YOU_CLICKED,c,a)};a.prototype.$22=function(){this.$7&&clearTimeout(this.$7),this.$6&&clearTimeout(this.$6)};a.prototype.$12=function(a,c,d,e,f,h,i,j,k){__p&&__p();f&&(b("LiveChatPluginLocalStorageUtil").init(d,e,"0"),h=b("LiveChatPluginLocalStorageUtil").getRequestID(),b("LiveChatPluginLocalStorageUtil").removeLocalState(d,e,i));b("LiveChatPluginLocalStorageUtil").init(d,e,i);var l=b("LiveChatPluginLocalStorageUtil").getLocalState(d,e,i);if(!l){if(f)this.$2=!1;else if(j!==b("LiveChatGreetingDialogDisplayMode").UNSET)this.$2=j===b("LiveChatGreetingDialogDisplayMode").HIDE||k>0;else if(this.$5&&this.$3){j=(l=b("MessengerLiveChatSettings").qeSettings)!=null?l.promptDefaultBehavior:l;this.$2=j===g.HIDE;this.$9=j!==null&&j!==g.SHOW}else this.$2=this.$3?!0:k>0;b("LiveChatPluginLocalStorageUtil").setLocalState(d,e,i,{chatStarted:f,isDialogHidden:this.$2,requestID:h,refSent:!1,showInterstitialOnPage:this.$9})}else this.$2=b("LiveChatPluginLocalStorageUtil").getIsDialogHidden(),this.$9=b("LiveChatPluginLocalStorageUtil").getShowInterstitialOnPage(),(!c||a)&&(b("LiveChatPluginLocalStorageUtil").setChatStarted(!1),b("LiveChatPluginLocalStorageUtil").setRefSent(!1)),b("LiveChatPluginLocalStorageUtil").setRequestID(h)};e.exports=a}),null);